(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{208:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(14),r=n.n(o),c=n(16),s=n(61),l=n(115),d=n(64),u=n(17),p=n(252),m=n(256),b=n(210),j=n(42),f=n(7),x=n(8),h=n.n(x),O=n(13),v=n(10),g=n(251),y=n(248),C=n(209),S=n(261),k=n(246),_=n(253),w=n(123),N=n.n(w),I=n(243),P=Object(I.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:e.spacing(2)},root:{"& .MuiTextField-root":{margin:e.spacing(1)}},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)},googleButton:{marginBottom:e.spacing(2)}}})),T=n(257),E=n(249),D=n(250),F=n(120),L=n.n(F),z=n(121),M=n.n(z),R=n(1),B=function(e){var t=e.name,n=e.handleChange,a=e.label,i=e.autoFocus,o=e.type,r=e.handleShowPassword;return Object(R.jsx)(k.a,{item:!0,xs:12,sm:12,children:Object(R.jsx)(T.a,{name:t,onChange:n,variant:"outlined",required:!0,fullWidth:!0,label:a,autoFocus:i,type:o,InputProps:"password"===t?{endAdornment:Object(R.jsx)(E.a,{position:"end",children:Object(R.jsx)(D.a,{onClick:r,children:"password"===o?Object(R.jsx)(L.a,{}):Object(R.jsx)(M.a,{})})})}:null})})},A="AUTH",W="LOGOUT",J="CREATE",U="FETCH_ALL",H="DELETE",V="UPDATE",K="COMMENT",q="START_LOADING",G="NEW_POST",X="END_LOADING",Y="NOTIFICATION",$="CHILD_CLICKED",Q="CLEAN_NOTIFICATION",Z="DELETE_NOTIFICATION",ee="IS_COMMENT",te="SHOW_COMMENT",ne=n(122),ae=n.n(ne).a.create({baseURL:"https://thuc-tap-20203-1.herokuapp.com/"});ae.interceptors.request.use((function(e){return localStorage.getItem("profile")&&(e.headers.authorization="Bearer ".concat(JSON.parse(localStorage.getItem("profile")).token)),e}));var ie,oe=function(e,t){return ae.post("/signin",e).catch((function(e){return alert(e.response.data.message)}))},re=function(e,t){return ae.post("/signup",e).catch((function(e){return alert(e.response.data.message)}))},ce=function(e){return ae.get("/posts/".concat(e))},se=function(e,t){return ae.get("/posts/".concat(e,"/comment/").concat(t))},le=function(e){return ae.post("/posts",e)},de=function(e){return ae.delete("/posts/".concat(e))},ue=function(e){return ae.patch("/posts/".concat(e,"/likePost"))},pe=function(e,t){return function(){var n=Object(O.a)(h.a.mark((function n(a){var i,o;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a({type:q}),n.next=4,oe(e);case 4:i=n.sent,(o=i.data).result.password=e.password,a({type:A,data:o}),a({type:X}),t.push("/"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),a({type:X}),console.log(n.t0.message);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e){return n.apply(this,arguments)}}()},me=function(e,t){return function(){var n=Object(O.a)(h.a.mark((function n(a){var i,o;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a({type:q}),n.next=4,re(e);case 4:i=n.sent,(o=i.data).result.password=e.password,a({type:A,data:o}),a({type:X}),t.push("/"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),a({type:X}),console.log(n.t0.message);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e){return n.apply(this,arguments)}}()},be=function(){var e=Object(c.c)((function(e){return e.auth})).isLoading,t=Object(a.useState)(!1),n=Object(v.a)(t,2),i=n[0],o=n[1],r=P(),s=Object(a.useState)({email:"",password:"",confirmPassword:""}),l=Object(v.a)(s,2),d=l[0],m=l[1],x=Object(a.useState)(!1),w=Object(v.a)(x,2),I=w[0],T=w[1],E=Object(u.g)(),D=Object(c.b)(),F=function(){var e=Object(O.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{D(i?me(d,E):pe(d,E))}catch(n){E.push("/auth")}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(e){m(Object(f.a)(Object(f.a)({},d),{},Object(j.a)({},e.target.name,e.target.value)))};return e?Object(R.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(R.jsx)(g.a,{style:{color:"white"}})}):Object(R.jsx)(y.a,{in:!0,children:Object(R.jsx)(p.a,{component:"main",maxWidth:"xs",children:Object(R.jsxs)(C.a,{className:r.paper,elevation:3,children:[Object(R.jsx)(S.a,{className:r.avatar,children:Object(R.jsx)(N.a,{})}),Object(R.jsx)(b.a,{component:"h1",variant:"h5",children:i?"\u0110\u0103ng k\xfd":"\u0110\u0103ng nh\u1eadp"}),Object(R.jsxs)("form",{className:r.form,onSubmit:F,children:[Object(R.jsxs)(k.a,{container:!0,spacing:2,children:[Object(R.jsx)(B,{name:"email",label:"Email Address",handleChange:L,type:"email"}),Object(R.jsx)(B,{name:"password",label:"Password",handleChange:L,type:I?"text":"password",handleShowPassword:function(){return T(!I)}}),i&&Object(R.jsx)(B,{name:"confirmPassword",label:"Confirm Password",handleChange:L,type:"password"})]}),Object(R.jsx)(_.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:r.submit,children:i?"\u0110\u0103ng k\xfd":"\u0110\u0103ng nh\u1eadp"}),Object(R.jsx)(k.a,{container:!0,justifyContent:"flex-end",children:Object(R.jsx)(k.a,{item:!0,children:Object(R.jsx)(_.a,{onClick:function(){o((function(e){return!e})),T(!1)},children:i?"\u0110\xe3 c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng nh\u1eadp":"Ch\u01b0a c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng k\xfd"})})})]})]})})})},je=Object(I.a)((function(e){return{posts:{marginTop:"40px"},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:e.spacing(2)},root:{"& .MuiTextField-root":{margin:e.spacing(1)}},form:{width:"100%",marginTop:e.spacing(3)}}})),fe=function(){return function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:q}),e.next=4,ae.get("/posts");case 4:n=e.sent,a=n.data,t({type:U,payload:a}),t({type:X}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.response),t({type:X});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},xe=function(e){return function(){var t=Object(O.a)(h.a.mark((function t(n){var a,i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,le(e);case 3:return a=t.sent,i=a.data,n({type:J,payload:i}),t.abrupt("return",i);case 9:t.prev=9,t.t0=t.catch(0),alert("".concat(t.t0.response.data.message)),localStorage.clear();case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},he=function(e){return function(){var t=Object(O.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,de(e);case 3:n({type:H,payload:e}),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),alert("".concat(t.t0.response.data.message)),localStorage.clear();case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},Oe=function(e){return function(){var t=Object(O.a)(h.a.mark((function t(n){var a,i;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ue(e);case 3:return a=t.sent,i=a.data,n({type:V,payload:i}),t.abrupt("return",i);case 9:t.prev=9,t.t0=t.catch(0),alert("B\xe0i vi\u1ebft kh\xf4ng kh\u1ea3 d\u1ee5ng"),n(fe());case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},ve=Object(I.a)((function(e){return{profile:{padding:"5px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",positon:"fixed"},txt:{marginBottom:"5px"},options:{display:"flex",justifyContent:"space-around"},icon:{color:"rgb(0,0,0,0.8)",padding:"13px",background:"rgb(0,255,255,0.4)",borderRadius:"50%","&:hover":{background:"rgb(0,255,255,0.5)",cursor:"pointer"}},notifi:{color:"red"}}})),ge=function(e){var t,n,a=e.user,i=e.handleLogout,o=ve();return Object(R.jsx)("div",{className:o.root_profile,children:Object(R.jsxs)(C.a,{style:{margin:"10px"},className:o.profile,children:[Object(R.jsx)("div",{className:o.txt,children:"Email: ".concat(null===a||void 0===a||null===(t=a.result)||void 0===t?void 0:t.email)}),Object(R.jsx)("div",{className:o.txt,children:"M\u1eadt kh\u1ea9u: ".concat(null===a||void 0===a||null===(n=a.result)||void 0===n?void 0:n.password)}),Object(R.jsx)(_.a,{onClick:i,color:"secondary",variant:"contained",children:"\u0110\u0103ng xu\u1ea5t"})]})})},ye=n(43),Ce=n(68),Se=n(212),ke=Object(Se.a)((function(e){return{post:{width:"100%",marginTop:"15px",padding:"5px"},newPost:{animation:"$myEffect 3000ms"},"@keyframes myEffect":{"0%":{opacity:0,transform:"translateY(-200%)"},"100%":{opacity:1,transform:"translateY(0)"}},post__top:{display:"flex",position:"relative",alignItems:"center",padding:"0 5px"},post__topInfo:{display:"flex",flex:"1",alignItems:"flex-start",flexDirection:"column"},post__delete:{"&:hover":{borderRadius:"999px",backgroundColor:"lightwhite",cursor:"pointer"}},h3__topInfo:{fontSize:"large"},date:{fontSize:"0.9rem",color:"gray"},post__avatar:{marginRight:"10px"},body:{padding:"0 10px 5px 10px"},post__image:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",background:"whitesmoke"},previousImage:{position:"absolute",cursor:"pointer",top:"45%",left:"0",padding:"5px"},nextImage:{position:"absolute",cursor:"pointer",top:"45%",right:"0",padding:"5px"},icon:{color:"black",opacity:"0.7"},haveImage:{flex:"0.7",width:"90%"},fileOther:{textDecoration:"none",color:"black",margin:"5px"},file:{backgroundColor:"#ADDCFF",textAlign:"center",borderRadius:"10px",padding:"2px"},post__options:{borderTop:"1px solid lightgray",display:"flex",justifyContent:"space-evenly",fontSize:"medium",color:"gray",cursor:"pointer",padding:"5px 5px 0 5px"},post__option:{display:"flex",alignItems:"center",justifyContent:"center",flex:"1","&:hover":{backgroundColor:"#eff2f5",borderRadius:"20px"}},comments:{marginTop:"5px",borderTop:"1px solid lightgray"}}})),_e=n(86),we=n.n(_e),Ne=n(126),Ie=n.n(Ne),Pe=n(130),Te=n.n(Pe),Ee=n(131),De=n.n(Ee),Fe=n(124),Le=n.n(Fe),ze=n(127),Me=n.n(ze),Re=n(128),Be=n.n(Re),Ae=n(129),We=n.n(Ae),Je=Object(I.a)((function(e){return{commentsOuterContainer:{padding:"5px",display:"flex",alignItems:"stretch",flexDirection:"column"},commentsInnerContainer:{margin:"5px 0",display:"flex",flexDirection:"column",alignItems:"flex-start"},form___comment:{display:"flex",borderRadius:"20px"},input__comment:{flex:"1",fontSize:"medium",padding:"10px",border:"none",borderRadius:"15px",backgroundColor:"whitesmoke",resize:"none",outline:"none"},list__comment:{padding:"5px 10px",borderRadius:"15px",backgroundColor:"whitesmoke"}}})),Ue=Object(I.a)((function(e){return{form___comment:{display:"flex",borderRadius:"20px"},input__comment:{flex:"1",fontSize:"medium",padding:"10px",border:"none",borderRadius:"15px",backgroundColor:"whitesmoke",resize:"none",outline:"none"},list__comment:{padding:"5px 10px",borderRadius:"15px",backgroundColor:"whitesmoke"}}})),He=["data","prevCommentId","totalSubcomment","_id"],Ve=function(e){var t=e.post,n=e.indexPost,i=e.c,o=(e.setNewSubCmtToSocket,e.subCommentToSocket),r=e.i,c=e.socket,s=e.idPost,l=e.email,d=e.isShowSubComments,u=(e.setTotalSubcomments,e.totalSubcomments),p=(e.setIsShowSubComments,Object(a.useState)(!1)),m=Object(v.a)(p,2),j=m[0],f=m[1],x=Object(a.useState)(""),h=Object(v.a)(x,2),O=h[0],y=h[1],C=Object(a.useState)(null===t||void 0===t?void 0:t.subComments),S=Object(v.a)(C,2),k=S[0],_=S[1],w=Ue();Object(a.useEffect)((function(){if(o&&d[r]&&c&&String(o.idPost)===String(null===t||void 0===t?void 0:t._id)&&String(o.prevCommentId)===String(i._id)){var e=o.data,n=o.prevCommentId,a=o.totalSubcomment,l=o._id;Object(Ce.a)(o,He);if(k||k===[]){for(var p=!1,m=0;m<k.length;m++)if(String(k[m]._id)===String(l)){p=!0;break}p||(_([].concat(Object(ye.a)(k),[{data:e,prevCommentId:n,totalSubcomment:a,_id:l}])),u.length>r&&t.subComments&&(t.subComments.push({data:e,prevCommentId:n,totalSubcomment:a,_id:l}),c.emit("increSubCmt",{idPost:s,i:r,idComment:i._id,idSubCmt:o._id},(function(){}))))}}}),[o]);return d[r]&&Object(R.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"5px 0"},children:[null===k||void 0===k?void 0:k.map((function(e){var t,n;return Object(R.jsxs)(b.a,{className:w.list__comment,variant:"subtitle2",style:{margin:"0 50px"},children:[Object(R.jsx)("strong",{children:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.split("::: ")[0]}),Object(R.jsx)("br",{}),null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.split("::: ")[1]]},e._id)})),Object(R.jsxs)("form",{className:w.form___comment,style:{margin:"0 50px"},onSubmit:function(e){if(e.preventDefault(),f(!0),O){var t=i._id;c.emit("send subComment",{email:l,idPost:s,data:O,prevId:t,i:r},(function(e){var a;e&&alert(e),y(""),f(!1),c.emit("send interaction",{email:l,idPost:s,data:O,prevId:t,indexPost:n,dataCmtPrev:null===i||void 0===i||null===(a=i.data)||void 0===a?void 0:a.split("::: ")[1],idCmtPrev:i._id,type:"SUB_COMMENT",indexOfSubCmt:r},(function(e){e&&alert(e)}))}))}},children:[Object(R.jsx)("input",{disabled:j,className:w.input__comment,value:O,autoFocus:!0,onChange:function(e){return y(e.target.value)},name:"subComment",type:"text",placeholder:"Vi\u1ebft b\xecnh lu\u1eadn"}),Object(R.jsx)("button",{type:"submit",hidden:!0,children:"Send"}),j&&Object(R.jsx)(g.a,{})]})]})},Ke=function(e){var t,n=e.post,i=e.subCommentToSocket,o=e.showSubCmt,r=e.setNewSubCmtToSocket,s=(e.handleShowComment,e.indexPost),l=e.socket,d=e.handleDelete,u=e.comments,p=(e.setComments,e.totalSubcomments),m=e.setTotalSubcomments,j=(e.opened,e.isLoadingComment),f=(e.setIsLoadingComment,JSON.parse(localStorage.getItem("profile"))),x=Object(a.useState)(""),y=Object(v.a)(x,2),C=y[0],S=y[1],k=Object(a.useState)(!1),_=Object(v.a)(k,2),w=_[0],N=_[1],I=Object(a.useState)(!1),P=Object(v.a)(I,2),T=P[0],E=P[1],D=Object(a.useState)([]),F=Object(v.a)(D,2),L=F[0],z=F[1],M=Object(c.c)((function(e){return e.posts})),B=(M.showComment,M.isComments,Je()),A=null===f||void 0===f||null===(t=f.result)||void 0===t?void 0:t.email,W=n._id;Object(a.useEffect)((function(){var e=[];z([]),e=Array(null===n||void 0===n?void 0:n.comments.length).fill(!1),L.push.apply(L,Object(ye.a)(e)),e=[],null===n||void 0===n||n.comments.forEach((function(t){return e.push(t.totalSubcomment)})),m(Object(ye.a)(e))}),[]),Object(a.useEffect)((function(){L[null===o||void 0===o?void 0:o.indexOfSubCmt]||H(null===o||void 0===o?void 0:o.indexOfSubCmt,null===o||void 0===o?void 0:o.idCmtPrev)}),[o]);var J=function(){var e=Object(O.a)(h.a.mark((function e(t,n){var a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(W,n);case 2:return a=e.sent,i=a.data,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(O.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),E(!0),C&&("",l.emit("send comment",{email:A,idPost:W,data:C,prevId:"",indexPost:s},(function(e){e&&(alert(e),d()),S(""),E(!1),l.emit("send interaction",{email:A,idPost:W,data:C,prevId:"",indexPost:s,type:"COMMENT"},(function(e){e&&alert(e)}))})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(O.a)(h.a.mark((function e(t,a){var i,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t>=L.length&&(i=Array(t-L.length+1).fill(!1),z(L.push.apply(L,Object(ye.a)(i)))),e.prev=1,e.next=4,z(null===L||void 0===L?void 0:L.map((function(e,n){return n===t&&!e})));case 4:return N(!0),w=!0,console.log("openedSubCmt",w),e.next=9,J(t,a);case 9:o=e.sent,n.subComments=o,e.next=15;break;case 13:e.prev=13,e.t0=e.catch(1);case 15:return e.prev=15,N(!1),w=!1,console.log("openedSubCmt",w),e.finish(15);case 20:case"end":return e.stop()}}),e,null,[[1,13,15,20]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(R.jsx)("div",{children:Object(R.jsxs)("div",{className:B.commentsOuterContainer,children:[j?Object(R.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(R.jsx)(g.a,{})}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(b.a,{variant:"subtitle2",children:[u.length+function(){var e=0;return(null===p||void 0===p?void 0:p.length)?(p.forEach((function(t){return e+=t})),e):0}()," l\u01b0\u1ee3t b\xecnh lu\u1eadn"]}),Object(R.jsx)("div",{className:B.commentsInnerContainer,children:null===u||void 0===u?void 0:u.map((function(e,t){var a,o;return Object(R.jsxs)("div",{style:{padding:"5px 10px",display:"flex",flexDirection:"column",width:"95%"},children:[Object(R.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0 10px"},children:[Object(R.jsxs)(b.a,{gutterBottom:!0,variant:"subtitle2",className:B.list__comment,children:[Object(R.jsx)("strong",{children:null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.split("::: ")[0]}),Object(R.jsx)("br",{}),null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.split("::: ")[1]]}),p[t]<=0&&Object(R.jsx)(b.a,{variant:"body2",onClick:function(){var n=e._id;H(t,n)},style:{width:"130px",cursor:"pointer",display:"flex",justifyContent:"start",fontSize:"0.8rem"},children:"Tr\u1ea3 l\u1eddi"})]}),p[t]>0&&Object(R.jsx)(b.a,{variant:"body2",onClick:function(){var n=e._id;H(t,n)},style:{cursor:"pointer",display:"flex",padding:"0px 5px",fontSize:"0.8rem"},color:"primary",children:L[t]?"Thu g\u1ecdn":"".concat(p[t]," l\u01b0\u1ee3t ph\u1ea3n h\u1ed3i")}),L[t]?w?Object(R.jsx)(g.a,{fontSize:"small"}):Object(R.jsx)(Ve,{post:n,c:e,i:t,indexPost:s,email:A,idPost:W,setNewSubCmtToSocket:r,socket:l,subCommentToSocket:i,isShowSubComments:L,openedSubCmt:w,setIsShowSubComments:z,setTotalSubcomments:m,totalSubcomments:p},t):null]},t)}))})]}),Object(R.jsxs)("form",{className:B.form___comment,onSubmit:U,children:[Object(R.jsx)("input",{disabled:T||j,className:B.input__comment,value:C,onChange:function(e){return S(e.target.value)},name:"comment",type:"text",placeholder:"Vi\u1ebft b\xecnh lu\u1eadn"}),Object(R.jsx)("button",{type:"submit",hidden:!0,children:"Send"}),T&&Object(R.jsx)(g.a,{})]})]})})},qe=n(125),Ge=n.n(qe),Xe=["data","prevCommentId","totalSubcomment","_id"],Ye=["i"],$e=function(e){var t,n=e.post,i=e.socket,o=e.newSubCmtToSocket,r=e.setCommentToSocket,s=e.setNewSubCmtToSocket,l=e.subCommentToSocket,d=e.indexPost,u=e.selected,p=e.refProp,m=e.commentToSocket,b=Object(a.useState)(!1),j=Object(v.a)(b,2),x=j[0],y=j[1],k=Object(a.useState)(!1),_=Object(v.a)(k,2),w=_[0],N=_[1],I=Object(a.useState)(!1),P=Object(v.a)(I,2),T=P[0],E=P[1],D=Object(a.useState)(!1),F=Object(v.a)(D,2),L=F[0],z=F[1],M=Object(a.useState)(!1),B=Object(v.a)(M,2),A=B[0],W=B[1],J=ke(),U=Object(c.b)(),H=JSON.parse(localStorage.getItem("profile")),V=Object(a.useState)(0),K=Object(v.a)(V,2),q=K[0],G=K[1],X=Object(a.useState)(0),Y=Object(v.a)(X,2),Q=Y[0],Z=Y[1],te=Object(c.c)((function(e){return e.posts})),ne=te.newPost,ae=te.isComments,ie=te.showComment,oe=te.childClicked,re=Object(a.useState)((null===n||void 0===n?void 0:n.comments)||[]),se=Object(v.a)(re,2),le=se[0],de=se[1],ue=Object(a.useState)([]),pe=Object(v.a)(ue,2),me=pe[0],be=pe[1],je=Object(a.useState)(null),fe=Object(v.a)(je,2),xe=fe[0],ve=fe[1];Object(a.useEffect)((function(){var e;u&&(null===p||void 0===p||null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"}),U({type:$,payload:-1}))}),[oe,U,p,u]),Object(a.useEffect)((function(){if(ie&&(null===ie||void 0===ie?void 0:ie.indexPost)===d&&(ae[d]||Fe(),"number"==typeof(null===ie||void 0===ie?void 0:ie.indexOfSubCmt)&&-1!==(null===ie||void 0===ie?void 0:ie.indexOfSubCmt))){var e=ie.indexOfSubCmt,t=ie.idCmtPrev;ve({indexOfSubCmt:e,idCmtPrev:t})}}),[ie]),Object(a.useEffect)((function(){if(m&&String(m.idPost)===String(null===n||void 0===n?void 0:n._id)){var e=m.data,t=m.prevCommentId,a=m.totalSubcomment,i=m._id,o=(Object(Ce.a)(m,Xe),[].concat(Object(ye.a)(le),[{data:e,prevCommentId:t,totalSubcomment:a,_id:i}]));de(o),n.comments.push({data:e,prevCommentId:t,totalSubcomment:a,_id:i});var c=[];null===n||void 0===n||n.comments.forEach((function(e){return c.push(e.totalSubcomment)})),be([].concat(c)),r(Object(f.a)(Object(f.a)({},m),{},{idPost:""}))}}),[m]),Object(a.useEffect)((function(){if(w&&o&&String(o.idPost)===String(null===n||void 0===n?void 0:n._id)){var e=o.i,t=(Object(Ce.a)(o,Ye),[]);if(null===n||void 0===n||n.comments.forEach((function(e){return t.push(e.totalSubcomment)})),me.push.apply(me,t),me||me===[]){var a=(null===n||void 0===n?void 0:n.comments[Number(e)].totalSubcomment)+1;me.splice(Number(e),1,a),n.comments[Number(e)].totalSubcomment=me[Number(e)],me.splice(t.length),be(me.slice(0))}-1!==o.i&&s({idPost:"",i:-1,idComment:"",idSubCmt:o.idSubCmt})}}),[o]);var ge=[],Se=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y(!0),e.next=4,U(he(n._id));case 4:y(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),_e=function(){var e;if(n.selectedFile.length>0&&(ge=n.selectedFile.filter((function(e){return e.type.includes("image")})),G(ge.length),ge.length>0))return Object(R.jsx)("img",{alt:"",className:J.haveImage,src:null===(e=ge[Q])||void 0===e?void 0:e.base64});return!1},Ne=function(){return n.selectedFile.length>0&&Object(R.jsx)(R.Fragment,{children:n.selectedFile.map((function(e){return e.type.includes("image")?null:Object(R.jsx)("a",{className:J.fileOther,title:e.name,href:e.base64,download:!0,children:Object(R.jsx)("div",{className:J.file,children:e.name},e.name)},e.name)}))})},Pe=function(){return n.likes.length>0&&n.likes.find((function(e){var t;return e===(null===H||void 0===H||null===(t=H.result)||void 0===t?void 0:t.email)}))?Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(Ie.a,{style:{color:"blue"}})}):Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(we.a,{})})},Ee=function(){var e=Object(O.a)(h.a.mark((function e(){var t,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,z(!0),e.next=4,U(Oe(n._id));case 4:t=e.sent,(a=t.likes.find((function(e){var t;return e===(null===H||void 0===H||null===(t=H.result)||void 0===t?void 0:t.email)})))&&i&&i.emit("send likeInteraction",{email:null===H||void 0===H||null===(o=H.result)||void 0===o?void 0:o.email,indexPost:d,idPost:n._id,title:n.message,data:t,isLike:a},(function(e){e&&alert(e)})),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:return e.prev=11,z(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,9,11,14]])})));return function(){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(O.a)(h.a.mark((function e(){var t,a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=25;break}return W(!0),e.prev=2,E(!0),e.next=6,ce(n._id);case 6:if(t=e.sent,!(a=t.data)){e.next=18;break}return n.comments=a,e.next=12,de(Object(ye.a)(a));case 12:return i=[],null===n||void 0===n||n.comments.forEach((function(e){return i.push(e.totalSubcomment)})),e.next=16,be([].concat(i));case 16:N(!0),E(!1);case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(2),console.log(e.t0),E(!1);case 24:W(!1);case 25:U({type:ee,payload:d});case 26:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(){return e.apply(this,arguments)}}();return Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(C.a,{className:Ge()(J.post,ne.is&&(null===ne||void 0===ne?void 0:ne.postId)===n._id?J.newPost:null),children:[Object(R.jsxs)("div",{className:J.post__top,children:[Object(R.jsx)(S.a,{className:J.post__avatar,children:n.creator[0]}),Object(R.jsxs)("div",{className:J.post__topInfo,children:[Object(R.jsx)("div",{className:J.h3__topInfo,children:n.creator}),Object(R.jsx)("div",{className:J.date,children:Le()(n.createdAt).format("L")})]}),(null===H||void 0===H||null===(t=H.result)||void 0===t?void 0:t.email)===n.creator&&Object(R.jsx)("div",{className:J.post__delete,onClick:Se,children:Object(R.jsx)(Me.a,{})})]}),x?Object(R.jsxs)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:[Object(R.jsx)(g.a,{}),"\u0110ang x\xf3a"]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{className:J.body,children:[Object(R.jsx)("div",{className:J.post__bottom,children:Object(R.jsx)("p",{children:n.message})}),Object(R.jsxs)("div",{className:J.post__image,children:[n.selectedFile&&Object(R.jsx)(_e,{}),q>1&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{onClick:function(){Z(0===Q?ge.length-1:Q-1)},className:J.previousImage,children:Object(R.jsx)(Be.a,{className:J.icon})}),Object(R.jsx)("div",{onClick:function(){Q===ge.length-1?Z(0):Z(Q+1)},className:J.nextImage,children:Object(R.jsx)(We.a,{className:J.icon})})]})]}),Object(R.jsx)("div",{className:J.post__file,style:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:n.selectedFile&&Object(R.jsx)(Ne,{})})]}),Object(R.jsxs)("div",{className:J.post__options,children:[L?Object(R.jsx)("div",{className:J.post__option,children:Object(R.jsx)(g.a,{})}):Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)("div",{className:J.post__option,onClick:Ee,children:[Object(R.jsx)(Pe,{}),Object(R.jsxs)("p",{style:{marginLeft:"10px"},children:[n.likes.length," Th\xedch"]})]})}),Object(R.jsxs)("div",{className:J.post__option,onClick:Fe,children:[Object(R.jsx)(Te.a,{}),Object(R.jsx)("p",{style:{marginLeft:"10px"},children:"B\xecnh lu\u1eadn"})]}),Object(R.jsxs)("div",{className:J.post__option,children:[Object(R.jsx)(De.a,{}),Object(R.jsx)("p",{style:{marginLeft:"10px"},children:"Chia s\u1ebb"})]})]}),A&&Object(R.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(R.jsx)(g.a,{})}),ae[d]&&Object(R.jsx)("div",{className:J.comments,children:Object(R.jsx)(Ke,{subCommentToSocket:l,setNewSubCmtToSocket:s,post:n,setIsLoadingComment:E,opened:w,isLoadingComment:T,socket:i,handleDelete:Se,comments:le,setComments:de,totalSubcomments:me,setTotalSubcomments:be,indexPost:d,handleShowComment:Fe,showSubCmt:xe})})]})]},n._id)})},Qe=Object(I.a)((function(e){return{createPost:{padding:"5px",display:"flex",flexDirection:"column",width:"100%"},header__createPost:{display:"flex",flexDirection:"row",borderBottom:"1px solid #eff2f5",padding:"5px",alignItems:"center"},form___createPost:{flex:"1",display:"flex"},input__createPost:{outlineWidth:"0",border:"none",padding:"10px 20px",margin:"0 10px",borderRadius:"999px",backgroundColor:"#eff2f5",flex:"1",fontSize:"1.05rem"},options__createPost:{display:"flex",justifyContent:"space-evenly"},option:{padding:"5px",display:"flex",alignItems:"center",justifyContent:"center",flex:"0.33",color:"gray",cursor:"pointer","&:hover":{backgroundColor:"#eff2f5",borderRadius:"20px"}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"10px",boxShadow:e.shadows[5]}}})),Ze=n(134),et=n.n(Ze),tt=n(135),nt=n.n(tt),at=n(136),it=n.n(at),ot=n(258),rt=n(254),ct=n(211),st=Object(I.a)((function(e){return{form:{padding:"5px",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},header:{maxWidth:"100%",fontSize:"medium",fontWeight:"bold",padding:"5px 0",textAlign:"center",borderBottom:"1px solid gray",display:"block"},body:{padding:"5px",display:"flex",flexDirection:"column"},top:{display:"flex",flexDirection:"flex-start",padding:"5px 0"},avatar:{marginRight:"5px"},info:{},detail:{display:"flex",alignItems:"center"},input_text:{padding:"10px",fontSize:"1.05rem",border:"none",backgroundColor:"whitesmoke",resize:"none",outline:"none"},image:{display:"flex",flexDirection:"column"},submit:{margin:"5px"},prevImage:{position:"relative"},closeImage:{position:"absolute",fontSize:"large",color:"blue",backgroundColor:"white",right:"10px",top:"5px",borderRadius:"50%",cursor:"pointer"},prevFile:{backgroundColor:"#ADDCFF",position:"relative",padding:"5px 35px 5px 10px",borderRadius:"20px",margin:"5px 5px 5px 0"},closeForm:{position:"absolute",padding:"0 5px",right:"0px",cursor:"pointer"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"10px",boxShadow:e.shadows[5]},filebase:{color:"blue"}}})),lt=n(132),dt=n.n(lt),ut=n(133),pt=n.n(ut),mt=n(77),bt=n.n(mt),jt=0,ft=function(e){var t,n,i,o=e.user,r=e.setOpen,s=e.socket,l=Object(a.useState)({message:"",creator:null===o||void 0===o||null===(t=o.result)||void 0===t?void 0:t.email,selectedFile:[]}),d=Object(v.a)(l,2),u=d[0],p=d[1],m=Object(a.useState)(!1),b=Object(v.a)(m,2),j=b[0],x=b[1],y=Object(a.useState)(!1),C=Object(v.a)(y,2),k=C[0],w=C[1],N=Object(c.b)(),I=st();Object(a.useEffect)((function(){u.selectedFile.forEach((function(e){"kB"===e.size.split(" ")[1]?jt+=Number(e.size.split(" ")[0]):jt+=1024*Number(e.size.split(" ")[0])})),x(jt>1e3),jt=0}),[u.selectedFile]);var P=function(e){var t=u.selectedFile.filter((function(t){return t.name!==e}));p(Object(f.a)(Object(f.a)({},u),{},{selectedFile:t}))},T=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,w(!0),e.next=5,N(xe(u));case 5:n=e.sent,r(!1),w(!1),a=null===n||void 0===n?void 0:n._id,s.emit("newPost",{postId:a},(function(){})),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),r(!1),w(!1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(R.jsx)(R.Fragment,{children:k?Object(R.jsx)("div",{style:{display:"flex",placeItems:"center"},children:Object(R.jsx)(g.a,{})}):Object(R.jsx)("div",{className:I.paper,children:Object(R.jsxs)("form",{autoComplete:"off",noValidate:!0,className:I.form,onSubmit:T,children:[Object(R.jsx)("div",{className:I.header,children:"T\u1ea1o b\xe0i vi\u1ebft"}),Object(R.jsxs)("div",{className:I.body,children:[Object(R.jsxs)("div",{className:I.top,children:[Object(R.jsx)(S.a,{className:I.avatar,children:null===o||void 0===o||null===(n=o.result)||void 0===n?void 0:n.email[0]}),Object(R.jsxs)("div",{className:I.info,children:[Object(R.jsx)("div",{style:{fontWeight:"bold"},children:null===o||void 0===o||null===(i=o.result)||void 0===i?void 0:i.email}),Object(R.jsxs)("div",{className:I.detail,children:[Object(R.jsx)(pt.a,{style:{fontSize:"medium"}}),Object(R.jsx)("div",{style:{marginLeft:"5px",fontSize:"0.9rem",color:"gray"},children:"B\u1ea1n b\xe8"})]})]})]}),Object(R.jsxs)("div",{className:I.main,children:[Object(R.jsx)("textarea",{onChange:function(e){return p(Object(f.a)(Object(f.a)({},u),{},{message:e.target.value}))},value:u.message,autoFocus:!0,name:"message",rows:"4",cols:"50",className:I.input_text,placeholder:"B\u1ea1n \u0111ang ngh\u0129 g\xec th\u1ebf?"}),Object(R.jsxs)("div",{className:I.image,children:[Object(R.jsx)("div",{style:{display:"flex",overflow:"auto",width:"485px"},children:u.selectedFile.map((function(e){return e.type.includes("image")?Object(R.jsxs)("div",{className:I.prevImage,children:[Object(R.jsx)("img",{src:e.base64,style:{height:"100px",marginRight:"5px",objectFit:"contain"},alt:""}),Object(R.jsx)(bt.a,{className:I.closeImage,onClick:function(){return P(e.name)}})]},e.name):null}))}),Object(R.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",width:"485px"},children:u.selectedFile.map((function(e){return e.type.includes("image")?null:Object(R.jsxs)("div",{className:I.prevFile,children:[e.name,Object(R.jsx)(bt.a,{className:I.closeImage,onClick:function(){return P(e.name)}})]},e.name)}))}),!u.selectedFile.length&&Object(R.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(R.jsx)("div",{style:{fontSize:"medium"},children:"Th\xeam t\u1ec7p"}),Object(R.jsx)(dt.a,{className:I.filebase,name:"selectedFile",type:"file",multiple:!0,onDone:function(e){return p(Object(f.a)(Object(f.a)({},u),{},{selectedFile:e}))}})]})]})]})]}),j&&Object(R.jsx)("div",{style:{color:"red",fontStyle:"italic",margin:"5px"},children:"V\u01b0\u1ee3t qu\xe1 k\xedch th\u01b0\u1edbc cho ph\xe9p"}),Object(R.jsx)(_.a,{disabled:""===u.message.trim()&&0===u.selectedFile.length||j,type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:I.submit,children:"\u0110\u0103ng"}),Object(R.jsx)(bt.a,{className:I.closeForm,onClick:function(){return r(!1)}})]})})})},xt=function(e){var t,n=e.user,i=e.socket,o=Object(a.useState)(!1),r=Object(v.a)(o,2),c=r[0],s=r[1],l=Qe();return Object(R.jsxs)(C.a,{className:l.createPost,children:[Object(R.jsxs)("div",{className:l.header__createPost,children:[Object(R.jsx)(S.a,{children:null===n||void 0===n||null===(t=n.result)||void 0===t?void 0:t.email[0]}),Object(R.jsx)("form",{className:l.form___createPost,children:Object(R.jsx)("input",{readOnly:!0,onClick:function(){s(!0)},className:l.input__createPost,type:"text",placeholder:"B\u1ea1n \u0111ang ngh\u0129 g\xec?"})})]}),Object(R.jsxs)("div",{className:l.options__createPost,children:[Object(R.jsxs)("div",{className:l.option,children:[Object(R.jsx)(et.a,{style:{color:"red"}}),Object(R.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"Video tr\u1ef1c ti\u1ebfp"})]}),Object(R.jsxs)("div",{className:l.option,children:[Object(R.jsx)(nt.a,{style:{color:"green"}}),Object(R.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"\u1ea2nh/Video"})]}),Object(R.jsxs)("div",{className:l.option,children:[Object(R.jsx)(it.a,{style:{color:"orange"}}),Object(R.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"C\u1ea3m x\xfac/Ho\u1ea1t \u0111\u1ed9ng"})]})]}),c&&Object(R.jsx)(ot.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:l.modal,open:c,closeAfterTransition:!0,BackdropComponent:rt.a,BackdropProps:{timeout:500},children:Object(R.jsx)(ct.a,{in:c,children:Object(R.jsx)(ft,{user:n,setOpen:s,socket:i})})})]})},ht=n(137),Ot=n(138),vt=n.n(Ot),gt=n(260),yt=n(259),Ct=Object(I.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}})),St=function(e){var t=e.socket,n=e.getRefs,i=Ct(),o=Object(c.b)(),r=Object(c.c)((function(e){return e.posts})).newPost;Object(a.useEffect)((function(){return t&&t.on("notification",function(){var e=Object(O.a)(h.a.mark((function e(t){var a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.error,i=t.post,a&&alert(a),!i){e.next=9;break}return e.next=5,o({type:G,payload:{is:!0,postId:null===i||void 0===i?void 0:i._id,postEmail:null===i||void 0===i?void 0:i.creator}});case 5:return e.next=7,o({type:J,payload:i});case 7:return e.next=9,n();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){t&&t.off("notification")}}),[o,t]);var s=function(e,t){"clickaway"!==t&&o({type:G,payload:{is:!1,postId:null}})};return Object(R.jsx)("div",{className:i.root,children:Object(R.jsx)(gt.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:r.is,autoHideDuration:6e3,onClose:s,children:Object(R.jsx)(yt.a,{onClose:s,severity:"success",elevation:6,variant:"filled",children:r.postEmail&&"".concat(null===r||void 0===r?void 0:r.postEmail," c\xf3 b\xe0i \u0111\u0103ng m\u1edbi")})})})},kt=n(255),_t=n(5),wt=n.p+"static/media/bell.7f6b1105.gif",Nt=Object(I.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2),zIndex:12},image:Object(j.a)({borderRadius:"50%",height:"60px",border:"2px solid lightgray"},e.breakpoints.down("xs"),{height:"40px"}),hidden:{position:"fixed",bottom:e.spacing(-50),right:e.spacing(-50)}}})),It=Object(I.a)((function(e){var t;return{root:(t={position:"fixed",bottom:e.spacing(12),right:e.spacing(3),border:"2px solid lightgray",maxWidth:"400px",background:"whitesmoke",borderRadius:"6px",maxHeight:"500px",overflow:"auto",zIndex:14},Object(j.a)(t,e.breakpoints.down("xs"),{bottom:e.spacing(9)}),Object(j.a)(t,"animation","$myEffect 1000ms"),t),"@keyframes myEffect":{"0%":{opacity:0,transform:"translateX(100%)"},"100%":{opacity:1,transform:"translateX(0)"}},notification:{padding:"10px","&:hover":{background:"lightgray",cursor:"pointer"}},truncate:{maxWidth:"60px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}})),Pt=function(e){var t=e.open,n=e.notifications,a=It(),i=Object(c.b)(),o=Object(c.c)((function(e){return e.posts})),r=o.isComments;o.showComment,o.childClicked;return t?Object(R.jsx)("div",{className:a.root,children:n.map((function(e,t){return Object(R.jsxs)("div",{onClick:function(){i({type:$,payload:null===e||void 0===e?void 0:e.indexPost}),i({type:Z,payload:t}),"COMMENT"===e.type?r[t]||i({type:te,payload:{indexPost:Number(null===e||void 0===e?void 0:e.indexPost),indexOfSubCmt:Number(e.indexOfSubCmt),idCmtPrev:e.idCmtPrev}}):"SUB_COMMENT"===e.type?i({type:te,payload:{indexPost:Number(null===e||void 0===e?void 0:e.indexPost),indexOfSubCmt:Number(e.indexOfSubCmt),idCmtPrev:e.idCmtPrev}}):"LIKE"===e.type&&i({type:V,payload:e.data})},className:a.notification,children:[Object(R.jsx)(b.a,{gutterBottom:!0,variant:"subtitle2",children:"COMMENT"===e.type?Object(R.jsxs)("span",{children:[e.email," \u0111\xe3 b\xecnh lu\u1eadn b\xe0i vi\u1ebft ",Object(R.jsx)("strong",{children:e.title.trim().length>=10?"".concat(e.title.substring(0,10)," ..."):e.title})," m\xe0 b\u1ea1n \u0111\xe3 t\u01b0\u01a1ng t\xe1c"]}):"SUB_COMMENT"===e.type?Object(R.jsxs)("span",{children:[e.email," \u0111\xe3 ph\u1ea3n h\u1ed3i b\xecnh lu\u1eadn ",Object(R.jsx)("strong",{children:e.dataCmtPrev.trim().length>=10?"".concat(e.dataCmtPrev.substring(0,10),"  ..."):e.dataCmtPrev})," trong b\xe0i vi\u1ebft ",Object(R.jsx)("strong",{children:e.title.length>=10?"".concat(e.title.substring(0,10)," ..."):e.title})," m\xe0 b\u1ea1n \u0111\xe3 t\u01b0\u01a1ng t\xe1c"]}):"LIKE"===e.type?Object(R.jsxs)("span",{children:[e.email," \u0111\xe3 th\xedch trong b\xe0i vi\u1ebft ",Object(R.jsx)("strong",{children:e.title.trim().length>=10?"".concat(e.title.substring(0,10)," ..."):e.title})," m\xe0 b\u1ea1n \u0111\xe3 t\u01b0\u01a1ng t\xe1c"]}):null}),("COMMENT"===e.type||"SUB_COMMENT"===e.type)&&Object(R.jsx)(b.a,{gutterBottom:!0,variant:"body2",color:"primary",style:{fontSize:"0.8rem",maxWidth:"350px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.data})]},t)}))}):null},Tt=Object(_t.a)((function(e){return{badge:{top:"15%",right:"10%",border:"2px solid lightgray",padding:"4px"}}}))(kt.a);function Et(e){var t=e.socket,n=i.a.useState(!1),o=Object(v.a)(n,2),r=o[0],s=o[1],l=Object(c.c)((function(e){return e.posts})).notifications,d=Object(c.b)(),u=Nt();return Object(a.useEffect)((function(){return t&&t.on("interaction",(function(e){var t=e.error,n=e.title,a=e.email,i=e.data,o=e.indexPost,r=e.type,c=e.dataCmtPrev,s=e.indexOfSubCmt,l=e.idCmtPrev;t&&alert(t),"COMMENT"===r?d({type:Y,payload:{email:a,data:i,title:n,indexPost:o,type:r,dataCmtPrev:"",indexOfSubCmt:-1,idCmtPrev:""}}):"SUB_COMMENT"===r?d({type:Y,payload:{email:a,data:i,title:n,indexPost:o,type:r,dataCmtPrev:c,indexOfSubCmt:s,idCmtPrev:l}}):"LIKE"===r&&d({type:Y,payload:{email:a,data:i,title:n,indexPost:o,type:r,dataCmtPrev:"",indexOfSubCmt:-1,idCmtPrev:""}})})),function(){t&&t.off("interaction")}}),[d,t]),Object(R.jsxs)("div",{children:[Object(R.jsx)(Pt,{open:r,notifications:l}),Object(R.jsx)(D.a,{"aria-label":"notification",onClick:function(){return s(!r)},className:l.length>0?u.root:u.hidden,children:Object(R.jsx)(Tt,{badgeContent:l.length,color:"secondary",children:Object(R.jsx)("img",{src:wt,className:u.image,alt:""})})})]})}var Dt=function(){var e=Object(a.useState)(JSON.parse(localStorage.getItem("profile"))?JSON.parse(localStorage.getItem("profile")):null),t=Object(v.a)(e,2),n=t[0],i=t[1],o=je(),r=Object(c.b)(),s=Object(u.g)(),l=Object(u.h)(),d=Object(c.c)((function(e){return e.posts})),m=d.posts,b=d.childClicked,j=d.isLoading,x=Object(a.useState)([]),C=Object(v.a)(x,2),S=C[0],_=C[1],w=Object(a.useState)(-2),N=Object(v.a)(w,2),I=N[0],P=N[1],T=Object(a.useState)({data:"",prevCommentId:"",totalSubcomment:0,_id:"",idPost:"",indexPost:-1}),E=Object(v.a)(T,2),D=E[0],F=E[1],L=Object(a.useState)({data:"",prevCommentId:"",totalSubcomment:"",_id:"",index:-1,idPost:""}),z=Object(v.a)(L,2),M=z[0],B=z[1],A=Object(a.useState)({idPost:"",i:-1,idComment:"",idSubCmt:""}),J=Object(v.a)(A,2),U=J[0],H=J[1],V=function(){r({type:W}),s.push("/auth")};Object(a.useEffect)((function(){r(fe())}),[r]);var K=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I+1!==m.length){e.next=5;break}return e.next=3,_((function(e){return Array(m.length).fill().map((function(t,n){return 0===n?Object(a.createRef)():e[n-1]}))}));case 3:e.next=7;break;case 5:return e.next=7,_((function(e){return Array(m.length).fill().map((function(e,t){return Object(a.createRef)()}))}));case 7:return e.next=9,P(m.length);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){K()}),[m]),Object(a.useEffect)((function(){var e=null===n||void 0===n?void 0:n.token;if(e&&1e3*Object(ht.a)(e).exp<(new Date).getTime())return V();return i(JSON.parse(localStorage.getItem("profile"))),ie=vt()("https://thuc-tap-20203-1.herokuapp.com/"),n&&ie.emit("home",{},(function(e){var t,a=e.error;e.home;a&&alert(a),ie.emit("set username",{username:null===n||void 0===n||null===(t=n.result)||void 0===t?void 0:t.email})})),function(){s.push("/auth"),ie.disconnect(),ie.off()}}),[l]),Object(a.useEffect)((function(){if(ie)return ie.on("comment",function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a,i,o,r,c,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.result,a=n.data,i=n.prevCommentId,o=n.totalSubcomment,r=n._id,c=t.idPost,s=t.indexPost,F({data:a,prevCommentId:i,totalSubcomment:o,_id:r,idPost:c,indexPost:s});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){ie.off("comment")}}),[D]),Object(a.useEffect)((function(){if(ie)return ie.on("newSubCmt",function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a,i,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.idPost,a=t.i,i=t.idComment,o=t.idSubCmt,String(U.idSubCmt)===String(o)){e.next=4;break}return e.next=4,H(Object(f.a)(Object(f.a)({},U),{},{idPost:n,i:a,idComment:i,idSubCmt:o}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){ie.off("newSubCmt")}}),[U]),Object(a.useEffect)((function(){if(ie)return ie.on("subComment",function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a,i,o,r,c,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.result,a=n.data,i=n.prevCommentId,o=n.totalSubcomment,r=n._id,c=t.index,s=t.idPost,B({data:a,prevCommentId:i,totalSubcomment:o,_id:r,index:c,idPost:s});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){ie.off("subComment")}}),[M]),j?Object(R.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(R.jsx)(g.a,{style:{color:"white"}})}):Object(R.jsx)(y.a,{in:!0,children:Object(R.jsx)(p.a,{component:"main",maxWidth:"lg",className:o.posts,children:n?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(St,{getRefs:K,socket:ie}),Object(R.jsx)(Et,{socket:ie}),Object(R.jsxs)(k.a,{container:!0,justifyContent:"center",alignItems:"stretch",spacing:3,children:[Object(R.jsx)(k.a,{item:!0,sm:12,md:3,children:Object(R.jsx)(ge,{user:n,socket:ie,handleLogout:V})}),Object(R.jsxs)(k.a,{item:!0,sm:12,md:8,children:[Object(R.jsx)(xt,{user:n,socket:ie}),m.map((function(e,t){return Object(R.jsx)("div",{ref:S[t],children:Object(R.jsx)($e,{newSubCmtToSocket:U,setNewSubCmtToSocket:H,commentToSocket:D,setCommentToSocket:F,selected:Number(b)===t,refProp:S[t],post:e,socket:ie,indexPost:t,subCommentToSocket:M},e._id)},t)}))]})]})]}):Object(R.jsx)(u.a,{to:"/auth"})})})},Ft=Object(Se.a)((function(e){return{appBar:{display:"flex",borderRadius:15,alignItems:"center",justifyContent:"center",flexDirection:"row"},heading:{color:"rgba(0, 183, 255,1)"}}})),Lt=function(){var e=Ft();return Object(R.jsx)(d.a,{children:Object(R.jsxs)(p.a,{maxWidth:"lg",children:[Object(R.jsx)(m.a,{className:e.appBar,position:"static",color:"inherit",children:Object(R.jsx)(b.a,{variant:"h2",align:"center",children:"B\xe0i \u0111\u0103ng"})}),Object(R.jsxs)(u.d,{children:[Object(R.jsx)(u.b,{path:"/",exact:!0,component:Dt}),Object(R.jsx)(u.b,{path:"/auth",exact:!0,component:be})]})]})})},zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{authData:null,isLoading:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return Object(f.a)(Object(f.a)({},e),{},{isLoading:!0});case X:return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1});case A:return localStorage.setItem("profile",JSON.stringify(Object(f.a)({},null===t||void 0===t?void 0:t.data))),Object(f.a)(Object(f.a)({},e),{},{authData:null});case W:return localStorage.clear(),Object(f.a)(Object(f.a)({},e),{},{authData:null});default:return e}},Mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{childClicked:-1,isComments:[],notifications:[],newPost:{},isLoading:!1,posts:[],showComment:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return Object(f.a)(Object(f.a)({},e),{},{isLoading:!0});case X:return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1});case $:return Object(f.a)(Object(f.a)({},e),{},{childClicked:t.payload});case Y:return e.notifications.unshift(t.payload),Object(f.a)({},e);case Q:return Object(f.a)(Object(f.a)({},e),{},{notifications:[]});case Z:return Object(f.a)(Object(f.a)({},e),{},{notifications:e.notifications.filter((function(e,n){return n!==t.payload}))});case G:return Object(f.a)(Object(f.a)({},e),{},{newPost:t.payload});case U:return Object(f.a)(Object(f.a)({},e),{},{posts:t.payload,isComments:Array(t.payload.length).fill(!1)});case J:return e.posts.unshift(t.payload),e.isComments.unshift(!1),Object(f.a)({},e);case ee:return Object(f.a)(Object(f.a)({},e),{},{isComments:e.isComments.map((function(e,n){return Number(n)===Number(t.payload)?!e:e}))});case te:return Object(f.a)(Object(f.a)({},e),{},{showComment:t.payload});case K:case V:return Object(f.a)(Object(f.a)({},e),{},{posts:e.posts.map((function(e){return e._id===t.payload._id?t.payload:e}))});case H:return Object(f.a)(Object(f.a)({},e),{},{posts:e.posts.filter((function(e){return e._id!==t.payload}))});default:return e}},Rt=Object(s.b)({auth:zt,posts:Mt}),Bt=Object(s.d)(Rt,Object(s.c)(Object(s.a)(l.a)));r.a.render(Object(R.jsx)(c.a,{store:Bt,children:Object(R.jsx)(Lt,{})}),document.getElementById("root"))}},[[208,1,2]]]);
//# sourceMappingURL=main.d4ab878c.chunk.js.map