(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{206:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(13),r=n.n(c),o=n(22),s=n(60),i=n(114),l=n(63),u=n(16),d=n(250),p=n(253),m=n(208),j=n(71),b=n(9),f=n(7),x=n.n(f),h=n(14),O=n(10),g=n(249),v=n(246),y=n(207),_=n(258),k=n(244),w=n(251),S=n(122),C=n.n(S),N=n(241),I=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:e.spacing(2)},root:{"& .MuiTextField-root":{margin:e.spacing(1)}},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)},googleButton:{marginBottom:e.spacing(2)}}})),D=n(254),F=n(247),E=n(248),P=n(119),T=n.n(P),L=n(120),z=n.n(L),R=n(2),B=function(e){var t=e.name,n=e.handleChange,a=e.label,c=e.autoFocus,r=e.type,o=e.handleShowPassword;return Object(R.jsx)(k.a,{item:!0,xs:12,sm:12,children:Object(R.jsx)(D.a,{name:t,onChange:n,variant:"outlined",required:!0,fullWidth:!0,label:a,autoFocus:c,type:r,InputProps:"password"===t?{endAdornment:Object(R.jsx)(F.a,{position:"end",children:Object(R.jsx)(E.a,{onClick:o,children:"password"===r?Object(R.jsx)(T.a,{}):Object(R.jsx)(z.a,{})})})}:null})})},A="AUTH",W="LOGOUT",J="CREATE",V="FETCH_ALL",M="DELETE",H="UPDATE",U="COMMENT",q="START_LOADING",G="NEW_POST",Y="END_LOADING",$=n(121),K=n.n($).a.create({baseURL:"https://thuc-tap-20203-1.herokuapp.com/"});K.interceptors.request.use((function(e){return localStorage.getItem("profile")&&(e.headers.authorization="Bearer ".concat(JSON.parse(localStorage.getItem("profile")).token)),e}));var Q,X=function(e,t){return K.post("/signin",e).catch((function(e){return alert(e.response.data.message)}))},Z=function(e,t){return K.post("/signup",e).catch((function(e){return alert(e.response.data.message)}))},ee=function(e){return K.get("/posts/".concat(e))},te=function(e,t){return K.get("/posts/".concat(e,"/comment/").concat(t))},ne=function(e){return K.post("/posts",e)},ae=function(e){return K.delete("/posts/".concat(e))},ce=function(e){return K.patch("/posts/".concat(e,"/likePost"))},re=function(e,t){return function(){var n=Object(h.a)(x.a.mark((function n(a){var c,r;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a({type:q}),n.next=4,X(e);case 4:c=n.sent,(r=c.data).result.password=e.password,a({type:A,data:r}),a({type:Y}),t.push("/"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),a({type:Y}),console.log(n.t0.message);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e){return n.apply(this,arguments)}}()},oe=function(e,t){return function(){var n=Object(h.a)(x.a.mark((function n(a){var c,r;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a({type:q}),n.next=4,Z(e);case 4:c=n.sent,(r=c.data).result.password=e.password,a({type:A,data:r}),a({type:Y}),t.push("/"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),a({type:Y}),console.log(n.t0.message);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e){return n.apply(this,arguments)}}()},se=function(){var e=Object(o.c)((function(e){return e.auth})).isLoading,t=Object(a.useState)(!1),n=Object(O.a)(t,2),c=n[0],r=n[1],s=I(),i=Object(a.useState)({email:"",password:"",confirmPassword:""}),l=Object(O.a)(i,2),p=l[0],f=l[1],S=Object(a.useState)(!1),N=Object(O.a)(S,2),D=N[0],F=N[1],E=Object(u.g)(),P=Object(o.b)(),T=function(){var e=Object(h.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{P(c?oe(p,E):re(p,E))}catch(n){E.push("/auth")}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(e){f(Object(b.a)(Object(b.a)({},p),{},Object(j.a)({},e.target.name,e.target.value)))};return e?Object(R.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(R.jsx)(g.a,{style:{color:"white"}})}):Object(R.jsx)(v.a,{in:!0,children:Object(R.jsx)(d.a,{component:"main",maxWidth:"xs",children:Object(R.jsxs)(y.a,{className:s.paper,elevation:3,children:[Object(R.jsx)(_.a,{className:s.avatar,children:Object(R.jsx)(C.a,{})}),Object(R.jsx)(m.a,{component:"h1",variant:"h5",children:c?"\u0110\u0103ng k\xfd":"\u0110\u0103ng nh\u1eadp"}),Object(R.jsxs)("form",{className:s.form,onSubmit:T,children:[Object(R.jsxs)(k.a,{container:!0,spacing:2,children:[Object(R.jsx)(B,{name:"email",label:"Email Address",handleChange:L,type:"email"}),Object(R.jsx)(B,{name:"password",label:"Password",handleChange:L,type:D?"text":"password",handleShowPassword:function(){return F(!D)}}),c&&Object(R.jsx)(B,{name:"confirmPassword",label:"Confirm Password",handleChange:L,type:"password"})]}),Object(R.jsx)(w.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:s.submit,children:c?"\u0110\u0103ng k\xfd":"\u0110\u0103ng nh\u1eadp"}),Object(R.jsx)(k.a,{container:!0,justifyContent:"flex-end",children:Object(R.jsx)(k.a,{item:!0,children:Object(R.jsx)(w.a,{onClick:function(){r((function(e){return!e})),F(!1)},children:c?"\u0110\xe3 c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng nh\u1eadp":"Ch\u01b0a c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng k\xfd"})})})]})]})})})},ie=Object(N.a)((function(e){return{posts:{marginTop:"40px"},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:e.spacing(2)},root:{"& .MuiTextField-root":{margin:e.spacing(1)}},form:{width:"100%",marginTop:e.spacing(3)}}})),le=function(){return function(){var e=Object(h.a)(x.a.mark((function e(t){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:q}),e.next=4,K.get("/posts");case 4:n=e.sent,a=n.data,t({type:V,payload:a}),t({type:Y}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.response),t({type:Y});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},ue=function(e){return function(){var t=Object(h.a)(x.a.mark((function t(n){var a,c;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne(e);case 3:return a=t.sent,c=a.data,n({type:J,payload:c}),console.log(c),t.abrupt("return",c);case 10:t.prev=10,t.t0=t.catch(0),alert("".concat(t.t0.response.data.message)),localStorage.clear();case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},de=function(e){return function(){var t=Object(h.a)(x.a.mark((function t(n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ae(e);case 3:n({type:M,payload:e}),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),alert("".concat(t.t0.response.data.message)),localStorage.clear();case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},pe=function(e){return function(){var t=Object(h.a)(x.a.mark((function t(n){var a,c;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ce(e);case 3:a=t.sent,c=a.data,n({type:H,payload:c}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),alert("B\xe0i vi\u1ebft kh\xf4ng kh\u1ea3 d\u1ee5ng"),n(le());case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},me=Object(N.a)((function(e){return{profile:{padding:"5px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",positon:"fixed"},txt:{marginBottom:"5px"},options:{display:"flex",justifyContent:"space-around"},icon:{color:"rgb(0,0,0,0.8)",padding:"13px",background:"rgb(0,255,255,0.4)",borderRadius:"50%","&:hover":{background:"rgb(0,255,255,0.5)",cursor:"pointer"}},notifi:{color:"red"}}})),je=function(e){var t,n,a=e.user,c=e.handleLogout,r=me();return Object(R.jsx)("div",{className:r.root_profile,children:Object(R.jsxs)(y.a,{style:{margin:"10px"},className:r.profile,children:[Object(R.jsx)("div",{className:r.txt,children:"Email: ".concat(null===a||void 0===a||null===(t=a.result)||void 0===t?void 0:t.email)}),Object(R.jsx)("div",{className:r.txt,children:"M\u1eadt kh\u1ea9u: ".concat(null===a||void 0===a||null===(n=a.result)||void 0===n?void 0:n.password)}),Object(R.jsx)(w.a,{onClick:c,color:"secondary",variant:"contained",children:"\u0110\u0103ng xu\u1ea5t"})]})})},be=n(210),fe=Object(be.a)((function(e){return{post:{width:"100%",marginTop:"15px",padding:"5px"},newPost:{animation:"$myEffect 3000ms"},"@keyframes myEffect":{"0%":{opacity:0,transform:"translateY(-200%)"},"100%":{opacity:1,transform:"translateY(0)"}},post__top:{display:"flex",position:"relative",alignItems:"center",padding:"0 5px"},post__topInfo:{display:"flex",flex:"1",alignItems:"flex-start",flexDirection:"column"},post__delete:{"&:hover":{borderRadius:"999px",backgroundColor:"lightwhite",cursor:"pointer"}},h3__topInfo:{fontSize:"large"},date:{fontSize:"0.9rem",color:"gray"},post__avatar:{marginRight:"10px"},body:{padding:"0 10px 5px 10px"},post__image:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",background:"whitesmoke"},previousImage:{position:"absolute",cursor:"pointer",top:"45%",left:"0",padding:"5px"},nextImage:{position:"absolute",cursor:"pointer",top:"45%",right:"0",padding:"5px"},icon:{color:"black",opacity:"0.7"},haveImage:{flex:"0.7",width:"90%"},fileOther:{textDecoration:"none",color:"black",margin:"5px"},file:{backgroundColor:"#ADDCFF",textAlign:"center",borderRadius:"10px",padding:"2px"},post__options:{borderTop:"1px solid lightgray",display:"flex",justifyContent:"space-evenly",fontSize:"medium",color:"gray",cursor:"pointer",padding:"5px 5px 0 5px"},post__option:{display:"flex",alignItems:"center",justifyContent:"center",flex:"1","&:hover":{backgroundColor:"#eff2f5",borderRadius:"20px"}},comments:{marginTop:"5px",borderTop:"1px solid lightgray"}}})),xe=n(85),he=n.n(xe),Oe=n(125),ge=n.n(Oe),ve=n(129),ye=n.n(ve),_e=n(130),ke=n.n(_e),we=n(123),Se=n.n(we),Ce=n(126),Ne=n.n(Ce),Ie=n(127),De=n.n(Ie),Fe=n(128),Ee=n.n(Fe),Pe=n(50),Te=Object(N.a)((function(e){return{commentsOuterContainer:{padding:"5px",display:"flex",alignItems:"stretch",flexDirection:"column"},commentsInnerContainer:{margin:"5px 0",display:"flex",flexDirection:"column",alignItems:"flex-start"},form___comment:{display:"flex",borderRadius:"20px"},input__comment:{flex:"1",fontSize:"medium",padding:"10px",border:"none",borderRadius:"15px",backgroundColor:"whitesmoke",resize:"none",outline:"none"},list__comment:{padding:"5px 10px",borderRadius:"15px",backgroundColor:"whitesmoke"}}})),Le=Object(N.a)((function(e){return{form___comment:{display:"flex",borderRadius:"20px"},input__comment:{flex:"1",fontSize:"medium",padding:"10px",border:"none",borderRadius:"15px",backgroundColor:"whitesmoke",resize:"none",outline:"none"},list__comment:{padding:"5px 10px",borderRadius:"15px",backgroundColor:"whitesmoke"}}})),ze=function(e){var t=e.post,n=e.c,c=e.i,r=e.socket,o=e.idPost,s=e.email,i=e.isShowSubComments,l=(e.setTotalSubcomments,e.totalSubcomments),u=(e.setIsShowSubComments,Object(a.useState)(!1)),d=Object(O.a)(u,2),p=d[0],j=d[1],b=Object(a.useState)(""),f=Object(O.a)(b,2),v=f[0],y=f[1],_=Object(a.useState)(null===t||void 0===t?void 0:t.subComments),k=Object(O.a)(_,2),w=k[0],S=k[1],C=Le();Object(a.useEffect)((function(){return r.on("subComment",function(){var e=Object(h.a)(x.a.mark((function e(n){var a,s,i,u,d,p,m;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.result,s=a.data,i=a.prevCommentId,u=a.totalSubcomment,d=a._id,console.log(w),!w&&w!==[]){e.next=16;break}p=!1,m=0;case 5:if(!(m<w.length)){e.next=12;break}if(String(w[m]._id)!==String(d)){e.next=9;break}return p=!0,e.abrupt("break",12);case 9:m++,e.next=5;break;case 12:if(p){e.next=16;break}return e.next=15,S([].concat(Object(Pe.a)(w),[{data:s,prevCommentId:i,totalSubcomment:u,_id:d}]));case 15:l.length>c&&t.subComments&&(t.subComments.push({data:s,prevCommentId:i,totalSubcomment:u,_id:d}),r.emit("increSubCmt",{idPost:o,i:c}));case 16:console.log(l),console.log(w);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){r.off("subComment")}}),[]);return i[c]&&Object(R.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"5px 0"},children:[null===w||void 0===w?void 0:w.map((function(e){var t,n;return Object(R.jsxs)(m.a,{className:C.list__comment,variant:"subtitle2",style:{margin:"0 50px"},children:[Object(R.jsx)("strong",{children:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.split("::: ")[0]}),Object(R.jsx)("br",{}),null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.split("::: ")[1]]},e._id)})),Object(R.jsxs)("form",{className:C.form___comment,style:{margin:"0 50px"},onSubmit:function(e){if(e.preventDefault(),j(!0),v){var t=n._id;r.emit("send subComment",{email:s,idPost:o,data:v,prevId:t},(function(e){e&&alert(e),y(""),j(!1)}))}},children:[Object(R.jsx)("input",{disabled:p,className:C.input__comment,value:v,autoFocus:!0,onChange:function(e){return y(e.target.value)},name:"subComment",type:"text",placeholder:"Vi\u1ebft b\xecnh lu\u1eadn"}),Object(R.jsx)("button",{type:"submit",hidden:!0,children:"Send"}),p&&Object(R.jsx)(g.a,{})]})]})},Re=function(e){var t,n=e.post,c=(e.isComment,e.socket),r=e.handleDelete,o=(e.opened,e.isLoadingComment),s=(e.setIsLoadingComment,JSON.parse(localStorage.getItem("profile"))),i=Object(a.useState)(""),l=Object(O.a)(i,2),u=l[0],d=l[1],p=Object(a.useState)(!1),j=Object(O.a)(p,2),b=j[0],f=j[1],v=Object(a.useState)(null===n||void 0===n?void 0:n.comments),y=Object(O.a)(v,2),_=y[0],k=y[1],w=Object(a.useState)(!1),S=Object(O.a)(w,2),C=S[0],N=S[1],I=Object(a.useState)([]),D=Object(O.a)(I,2),F=D[0],E=D[1],P=Object(a.useState)([]),T=Object(O.a)(P,2),L=T[0],z=T[1],B=Te(),A=null===s||void 0===s||null===(t=s.result)||void 0===t?void 0:t.email,W=n._id;Object(a.useEffect)((function(){var e=[];E([]),e=Array(null===n||void 0===n?void 0:n.comments.length).fill(!1),F.push.apply(F,Object(Pe.a)(e)),e=[],null===n||void 0===n||n.comments.forEach((function(t){return e.push(t.totalSubcomment)})),z(Object(Pe.a)(e)),console.log("start comment",F,L)}),[]),Object(a.useEffect)((function(){return console.log("useEffect comment"),c.on("comment",function(){var e=Object(h.a)(x.a.mark((function e(t){var a,c,r,o,s,i,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.result,c=a.data,r=a.prevCommentId,o=a.totalSubcomment,s=a._id,i=[].concat(Object(Pe.a)(_),[{data:c,prevCommentId:r,totalSubcomment:o,_id:s}]),e.next=4,k(i);case 4:return console.log(_),n.comments.push({data:c,prevCommentId:r,totalSubcomment:o,_id:s}),l=[],null===n||void 0===n||n.comments.forEach((function(e){return l.push(e.totalSubcomment)})),e.next=10,z([].concat(l));case 10:console.log(L);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){c.off("comment")}}),[]),Object(a.useEffect)((function(){return c.on("newSubCmt",function(){var e=Object(h.a)(x.a.mark((function e(t){var a,c,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.i,c=[],null===n||void 0===n||n.comments.forEach((function(e){return c.push(e.totalSubcomment)})),L.push.apply(L,c),!L&&L!==[]){e.next=11;break}return r=L[Number(a)]+1,L.splice(Number(a),1,r),n.comments[Number(a)].totalSubcomment=L[Number(a)],L.splice(c.length),e.next=11,z(L.slice(0));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){c.off("newSubCmt")}}),[]);var J=function(){var e=Object(h.a)(x.a.mark((function e(t,n){var a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(W,n);case 2:return a=e.sent,c=a.data,console.log(c),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),V=function(){var e=Object(h.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),N(!0),u&&("",c.emit("send comment",{email:A,idPost:W,data:u,prevId:""},(function(e){e&&(alert(e),r()),d(""),N(!1)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(h.a)(x.a.mark((function e(t,a){var c,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t>=F.length&&(c=Array(t-F.length+1).fill(!1),E(F.push.apply(F,Object(Pe.a)(c)))),e.prev=1,e.next=4,E(null===F||void 0===F?void 0:F.map((function(e,n){return n===t&&!e})));case 4:return f(!0),b=!0,console.log("openedSubCmt",b),e.next=9,J(t,a);case 9:r=e.sent,n.subComments=r,e.next=15;break;case 13:e.prev=13,e.t0=e.catch(1);case 15:return e.prev=15,f(!1),b=!1,console.log("openedSubCmt",b),e.finish(15);case 20:console.log(F);case 21:case"end":return e.stop()}}),e,null,[[1,13,15,20]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(R.jsx)("div",{children:Object(R.jsxs)("div",{className:B.commentsOuterContainer,children:[o?Object(R.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(R.jsx)(g.a,{})}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(m.a,{variant:"subtitle2",children:[_.length+function(){var e=0;return(null===L||void 0===L?void 0:L.length)?(L.forEach((function(t){return e+=t})),e):0}()," l\u01b0\u1ee3t b\xecnh lu\u1eadn"]}),Object(R.jsx)("div",{className:B.commentsInnerContainer,children:null===_||void 0===_?void 0:_.map((function(e,t){var a,r;return Object(R.jsxs)("div",{style:{padding:"5px 10px",display:"flex",flexDirection:"column",width:"95%"},children:[Object(R.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0 10px"},children:[Object(R.jsxs)(m.a,{gutterBottom:!0,variant:"subtitle2",className:B.list__comment,children:[Object(R.jsx)("strong",{children:null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.split("::: ")[0]}),Object(R.jsx)("br",{}),null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.split("::: ")[1]]}),L[t]<=0&&Object(R.jsx)(m.a,{variant:"body2",onClick:function(){var n=e._id;M(t,n)},style:{width:"130px",cursor:"pointer",display:"flex",justifyContent:"start",fontSize:"0.8rem"},children:"Tr\u1ea3 l\u1eddi"})]}),L[t]>0&&Object(R.jsx)(m.a,{variant:"body2",onClick:function(){var n=e._id;M(t,n)},style:{cursor:"pointer",display:"flex",padding:"0px 5px",fontSize:"0.8rem"},color:"primary",children:F[t]?"Thu g\u1ecdn":"".concat(L[t]," l\u01b0\u1ee3t ph\u1ea3n h\u1ed3i")}),F[t]?b?Object(R.jsx)(g.a,{fontSize:"small"}):Object(R.jsx)(ze,{post:n,c:e,i:t,email:A,idPost:W,socket:c,isShowSubComments:F,openedSubCmt:b,setIsShowSubComments:E,setTotalSubcomments:z,totalSubcomments:L},t):null]},t)}))})]}),Object(R.jsxs)("form",{className:B.form___comment,onSubmit:V,children:[Object(R.jsx)("input",{disabled:C||o,className:B.input__comment,value:u,onChange:function(e){return d(e.target.value)},name:"comment",type:"text",placeholder:"Vi\u1ebft b\xecnh lu\u1eadn"}),Object(R.jsx)("button",{type:"submit",hidden:!0,children:"Send"}),C&&Object(R.jsx)(g.a,{})]})]})})},Be=n(124),Ae=n.n(Be),We=function(e){var t,n=e.post,c=e.socket,r=Object(a.useState)(!1),s=Object(O.a)(r,2),i=s[0],l=s[1],u=Object(a.useState)(!1),d=Object(O.a)(u,2),p=d[0],m=d[1],j=Object(a.useState)(!1),b=Object(O.a)(j,2),f=b[0],v=b[1],k=Object(a.useState)(!1),w=Object(O.a)(k,2),S=w[0],C=w[1],N=Object(a.useState)(!1),I=Object(O.a)(N,2),D=I[0],F=I[1],E=Object(a.useState)(!1),P=Object(O.a)(E,2),T=P[0],L=P[1],z=fe(),B=Object(o.b)(),A=JSON.parse(localStorage.getItem("profile")),W=Object(a.useState)(0),J=Object(O.a)(W,2),V=J[0],M=J[1],H=Object(a.useState)(0),U=Object(O.a)(H,2),q=U[0],G=U[1],Y=Object(o.c)((function(e){return e.posts})).newPost;Object(a.useEffect)((function(){if(console.log("useEffect post"),f){var e=n._id;c.emit("join",{postId:e,user:A},(function(e){var t=e.error;e.post;t&&alert(t)}))}}),[f,c,n._id,A]);var $=[],K=function(){var e=Object(h.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l(!0),e.next=4,B(de(n._id));case 4:l(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e;if(n.selectedFile.length>0&&($=n.selectedFile.filter((function(e){return e.type.includes("image")})),M($.length),$.length>0))return Object(R.jsx)("img",{alt:"",className:z.haveImage,src:null===(e=$[q])||void 0===e?void 0:e.base64});return!1},X=function(){return n.selectedFile.length>0&&Object(R.jsx)(R.Fragment,{children:n.selectedFile.map((function(e){return e.type.includes("image")?null:Object(R.jsx)("a",{className:z.fileOther,title:e.name,href:e.base64,download:!0,children:Object(R.jsx)("div",{className:z.file,children:e.name},e.name)},e.name)}))})},Z=function(){return n.likes.length>0&&n.likes.find((function(e){var t;return e===(null===A||void 0===A||null===(t=A.result)||void 0===t?void 0:t._id)}))?Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(ge.a,{style:{color:"blue"}})}):Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(he.a,{})})},te=function(){var e=Object(h.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,F(!0),e.next=4,B(pe(n._id));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:return e.prev=8,F(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[0,6,8,11]])})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(h.a)(x.a.mark((function e(){var t,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=17;break}return L(!0),e.prev=2,C(!0),e.next=6,ee(n._id);case 6:t=e.sent,a=t.data,console.log(a),a&&(n.comments=a,console.log("..."),m(!0),C(!1)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0),C(!1);case 16:L(!1);case 17:v(!f);case 18:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}();return Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(y.a,{className:Ae()(z.post,Y.is&&(null===Y||void 0===Y?void 0:Y.postId)===n._id?z.newPost:null),children:[Object(R.jsxs)("div",{className:z.post__top,children:[Object(R.jsx)(_.a,{className:z.post__avatar,children:n.creator[0]}),Object(R.jsxs)("div",{className:z.post__topInfo,children:[Object(R.jsx)("div",{className:z.h3__topInfo,children:n.creator}),Object(R.jsx)("div",{className:z.date,children:Se()(n.createdAt).format("L")})]}),(null===A||void 0===A||null===(t=A.result)||void 0===t?void 0:t.email)===n.creator&&Object(R.jsx)("div",{className:z.post__delete,onClick:K,children:Object(R.jsx)(Ne.a,{})})]}),i?Object(R.jsxs)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:[Object(R.jsx)(g.a,{}),"\u0110ang x\xf3a"]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{className:z.body,children:[Object(R.jsx)("div",{className:z.post__bottom,children:Object(R.jsx)("p",{children:n.message})}),Object(R.jsxs)("div",{className:z.post__image,children:[n.selectedFile&&Object(R.jsx)(Q,{}),V>1&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{onClick:function(){G(0===q?$.length-1:q-1)},className:z.previousImage,children:Object(R.jsx)(De.a,{className:z.icon})}),Object(R.jsx)("div",{onClick:function(){q===$.length-1?G(0):G(q+1)},className:z.nextImage,children:Object(R.jsx)(Ee.a,{className:z.icon})})]})]}),Object(R.jsx)("div",{className:z.post__file,style:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:n.selectedFile&&Object(R.jsx)(X,{})})]}),Object(R.jsxs)("div",{className:z.post__options,children:[D?Object(R.jsx)("div",{className:z.post__option,children:Object(R.jsx)(g.a,{})}):Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)("div",{className:z.post__option,onClick:te,children:[Object(R.jsx)(Z,{}),Object(R.jsxs)("p",{style:{marginLeft:"10px"},children:[n.likes.length," Th\xedch"]})]})}),Object(R.jsxs)("div",{className:z.post__option,onClick:ne,children:[Object(R.jsx)(ye.a,{}),Object(R.jsx)("p",{style:{marginLeft:"10px"},children:"B\xecnh lu\u1eadn"})]}),Object(R.jsxs)("div",{className:z.post__option,children:[Object(R.jsx)(ke.a,{}),Object(R.jsx)("p",{style:{marginLeft:"10px"},children:"Chia s\u1ebb"})]})]}),T&&Object(R.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(R.jsx)(g.a,{})}),f&&Object(R.jsx)("div",{className:z.comments,children:Object(R.jsx)(Re,{isComment:f,post:n,setIsLoadingComment:C,opened:p,isLoadingComment:S,socket:c,handleDelete:K})})]})]},n._id)})},Je=Object(N.a)((function(e){return{createPost:{padding:"5px",display:"flex",flexDirection:"column",width:"100%"},header__createPost:{display:"flex",flexDirection:"row",borderBottom:"1px solid #eff2f5",padding:"5px",alignItems:"center"},form___createPost:{flex:"1",display:"flex"},input__createPost:{outlineWidth:"0",border:"none",padding:"10px 20px",margin:"0 10px",borderRadius:"999px",backgroundColor:"#eff2f5",flex:"1",fontSize:"1.05rem"},options__createPost:{display:"flex",justifyContent:"space-evenly"},option:{padding:"5px",display:"flex",alignItems:"center",justifyContent:"center",flex:"0.33",color:"gray",cursor:"pointer","&:hover":{backgroundColor:"#eff2f5",borderRadius:"20px"}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"10px",boxShadow:e.shadows[5]}}})),Ve=n(133),Me=n.n(Ve),He=n(134),Ue=n.n(He),qe=n(135),Ge=n.n(qe),Ye=n(255),$e=n(252),Ke=n(209),Qe=Object(N.a)((function(e){return{form:{padding:"5px",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},header:{maxWidth:"100%",fontSize:"medium",fontWeight:"bold",padding:"5px 0",textAlign:"center",borderBottom:"1px solid gray",display:"block"},body:{padding:"5px",display:"flex",flexDirection:"column"},top:{display:"flex",flexDirection:"flex-start",padding:"5px 0"},avatar:{marginRight:"5px"},info:{},detail:{display:"flex",alignItems:"center"},input_text:{padding:"10px",fontSize:"1.05rem",border:"none",backgroundColor:"whitesmoke",resize:"none",outline:"none"},image:{display:"flex",flexDirection:"column"},submit:{margin:"5px"},prevImage:{position:"relative"},closeImage:{position:"absolute",fontSize:"large",color:"blue",backgroundColor:"white",right:"10px",top:"5px",borderRadius:"50%",cursor:"pointer"},prevFile:{backgroundColor:"#ADDCFF",position:"relative",padding:"5px 35px 5px 10px",borderRadius:"20px",margin:"5px 5px 5px 0"},closeForm:{position:"absolute",padding:"0 5px",right:"0px",cursor:"pointer"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"10px",boxShadow:e.shadows[5]},filebase:{color:"blue"}}})),Xe=n(131),Ze=n.n(Xe),et=n(132),tt=n.n(et),nt=n(76),at=n.n(nt),ct=0,rt=function(e){var t,n,c,r=e.user,s=e.setOpen,i=e.socket,l=Object(a.useState)({message:"",creator:null===r||void 0===r||null===(t=r.result)||void 0===t?void 0:t.email,selectedFile:[]}),u=Object(O.a)(l,2),d=u[0],p=u[1],m=Object(a.useState)(!1),j=Object(O.a)(m,2),f=j[0],v=j[1],y=Object(a.useState)(!1),k=Object(O.a)(y,2),S=k[0],C=k[1],N=Object(o.b)(),I=Qe();Object(a.useEffect)((function(){d.selectedFile.forEach((function(e){"kB"===e.size.split(" ")[1]?ct+=Number(e.size.split(" ")[0]):ct+=1024*Number(e.size.split(" ")[0])})),v(ct>1e3),ct=0}),[d.selectedFile]);var D=function(e){var t=d.selectedFile.filter((function(t){return t.name!==e}));p(Object(b.a)(Object(b.a)({},d),{},{selectedFile:t}))},F=function(){var e=Object(h.a)(x.a.mark((function e(t){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(d),e.prev=2,C(!0),e.next=6,N(ue(d));case 6:n=e.sent,s(!1),C(!1),a=null===n||void 0===n?void 0:n._id,i.emit("newPost",{postId:a},(function(){})),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(2),s(!1),C(!1),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(R.jsx)(R.Fragment,{children:S?Object(R.jsx)("div",{style:{display:"flex",placeItems:"center"},children:Object(R.jsx)(g.a,{})}):Object(R.jsx)("div",{className:I.paper,children:Object(R.jsxs)("form",{autoComplete:"off",noValidate:!0,className:I.form,onSubmit:F,children:[Object(R.jsx)("div",{className:I.header,children:"T\u1ea1o b\xe0i vi\u1ebft"}),Object(R.jsxs)("div",{className:I.body,children:[Object(R.jsxs)("div",{className:I.top,children:[Object(R.jsx)(_.a,{className:I.avatar,children:null===r||void 0===r||null===(n=r.result)||void 0===n?void 0:n.email[0]}),Object(R.jsxs)("div",{className:I.info,children:[Object(R.jsx)("div",{style:{fontWeight:"bold"},children:null===r||void 0===r||null===(c=r.result)||void 0===c?void 0:c.email}),Object(R.jsxs)("div",{className:I.detail,children:[Object(R.jsx)(tt.a,{style:{fontSize:"medium"}}),Object(R.jsx)("div",{style:{marginLeft:"5px",fontSize:"0.9rem",color:"gray"},children:"B\u1ea1n b\xe8"})]})]})]}),Object(R.jsxs)("div",{className:I.main,children:[Object(R.jsx)("textarea",{onChange:function(e){return p(Object(b.a)(Object(b.a)({},d),{},{message:e.target.value}))},value:d.message,autoFocus:!0,name:"message",rows:"4",cols:"50",className:I.input_text,placeholder:"B\u1ea1n \u0111ang ngh\u0129 g\xec th\u1ebf?"}),Object(R.jsxs)("div",{className:I.image,children:[Object(R.jsx)("div",{style:{display:"flex",overflow:"auto",width:"485px"},children:d.selectedFile.map((function(e){return e.type.includes("image")?Object(R.jsxs)("div",{className:I.prevImage,children:[Object(R.jsx)("img",{src:e.base64,style:{height:"100px",marginRight:"5px",objectFit:"contain"},alt:""}),Object(R.jsx)(at.a,{className:I.closeImage,onClick:function(){return D(e.name)}})]},e.name):null}))}),Object(R.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",width:"485px"},children:d.selectedFile.map((function(e){return e.type.includes("image")?null:Object(R.jsxs)("div",{className:I.prevFile,children:[e.name,Object(R.jsx)(at.a,{className:I.closeImage,onClick:function(){return D(e.name)}})]},e.name)}))}),!d.selectedFile.length&&Object(R.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(R.jsx)("div",{style:{fontSize:"medium"},children:"Th\xeam t\u1ec7p"}),Object(R.jsx)(Ze.a,{className:I.filebase,name:"selectedFile",type:"file",multiple:!0,onDone:function(e){return p(Object(b.a)(Object(b.a)({},d),{},{selectedFile:e}))}})]})]})]})]}),f&&Object(R.jsx)("div",{style:{color:"red",fontStyle:"italic",margin:"5px"},children:"V\u01b0\u1ee3t qu\xe1 k\xedch th\u01b0\u1edbc cho ph\xe9p"}),Object(R.jsx)(w.a,{disabled:""===d.message.trim()&&0===d.selectedFile.length||f,type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:I.submit,children:"\u0110\u0103ng"}),Object(R.jsx)(at.a,{className:I.closeForm,onClick:function(){return s(!1)}})]})})})},ot=function(e){var t,n=e.user,c=e.socket,r=Object(a.useState)(!1),o=Object(O.a)(r,2),s=o[0],i=o[1],l=Je();return Object(R.jsxs)(y.a,{className:l.createPost,children:[Object(R.jsxs)("div",{className:l.header__createPost,children:[Object(R.jsx)(_.a,{children:null===n||void 0===n||null===(t=n.result)||void 0===t?void 0:t.email[0]}),Object(R.jsx)("form",{className:l.form___createPost,children:Object(R.jsx)("input",{readOnly:!0,onClick:function(){i(!0)},className:l.input__createPost,type:"text",placeholder:"B\u1ea1n \u0111ang ngh\u0129 g\xec?"})})]}),Object(R.jsxs)("div",{className:l.options__createPost,children:[Object(R.jsxs)("div",{className:l.option,children:[Object(R.jsx)(Me.a,{style:{color:"red"}}),Object(R.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"Video tr\u1ef1c ti\u1ebfp"})]}),Object(R.jsxs)("div",{className:l.option,children:[Object(R.jsx)(Ue.a,{style:{color:"green"}}),Object(R.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"\u1ea2nh/Video"})]}),Object(R.jsxs)("div",{className:l.option,children:[Object(R.jsx)(Ge.a,{style:{color:"orange"}}),Object(R.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"C\u1ea3m x\xfac/Ho\u1ea1t \u0111\u1ed9ng"})]})]}),s&&Object(R.jsx)(Ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:l.modal,open:s,closeAfterTransition:!0,BackdropComponent:$e.a,BackdropProps:{timeout:500},children:Object(R.jsx)(Ke.a,{in:s,children:Object(R.jsx)(rt,{user:n,setOpen:i,socket:c})})})]})},st=n(136),it=n(137),lt=n.n(it),ut=n(257),dt=n(256),pt=Object(N.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}})),mt=function(e){var t=e.socket,n=pt(),c=Object(o.b)(),r=Object(o.c)((function(e){return e.posts})).newPost;Object(a.useEffect)((function(){return t&&t.on("notification",(function(e){var t=e.error,n=e.post;t&&alert(t),n&&(console.log(n),c({type:G,payload:{is:!0,postId:null===n||void 0===n?void 0:n._id,postEmail:null===n||void 0===n?void 0:n.creator}}),c({type:J,payload:n}))})),function(){t&&t.off("notification")}}),[]);var s=function(e,t){"clickaway"!==t&&c({type:G,payload:{is:!1,postId:null}})};return Object(R.jsx)("div",{className:n.root,children:Object(R.jsx)(ut.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:r.is,autoHideDuration:6e3,onClose:s,children:Object(R.jsx)(dt.a,{onClose:s,severity:"success",elevation:6,variant:"filled",children:r.postEmail&&"".concat(null===r||void 0===r?void 0:r.postEmail," c\xf3 b\xe0i \u0111\u0103ng m\u1edbi")})})})},jt=function(){var e=Object(a.useState)(JSON.parse(localStorage.getItem("profile"))?JSON.parse(localStorage.getItem("profile")):null),t=Object(O.a)(e,2),n=t[0],c=t[1],r=ie(),s=Object(o.b)(),i=Object(u.g)(),l=Object(u.h)(),p=Object(o.c)((function(e){return e.posts})),m=p.posts,j=p.isLoading,b=function(){s({type:W}),i.push("/auth")};return Object(a.useEffect)((function(){console.log("useEffect posts"),s(le())}),[s]),Object(a.useEffect)((function(){console.log("useEffect posts");var e=null===n||void 0===n?void 0:n.token;if(e&&1e3*Object(st.a)(e).exp<(new Date).getTime())return b();return c(JSON.parse(localStorage.getItem("profile"))),Q=lt()("https://thuc-tap-20203-1.herokuapp.com/"),n&&Q.emit("home",{},(function(e){var t=e.error;e.home;t&&alert(t)})),function(){i.push("/auth"),Q.disconnect(),Q.off()}}),[l]),j?Object(R.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(R.jsx)(g.a,{style:{color:"white"}})}):Object(R.jsx)(v.a,{in:!0,children:Object(R.jsx)(d.a,{component:"main",maxWidth:"lg",className:r.posts,children:n?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(mt,{socket:Q}),Object(R.jsxs)(k.a,{container:!0,justifyContent:"center",alignItems:"stretch",spacing:3,children:[Object(R.jsx)(k.a,{item:!0,sm:12,md:3,children:Object(R.jsx)(je,{user:n,socket:Q,handleLogout:b})}),Object(R.jsxs)(k.a,{item:!0,sm:12,md:8,children:[Object(R.jsx)(ot,{user:n,socket:Q}),m.map((function(e){return Object(R.jsx)(We,{post:e,socket:Q},e._id)}))]})]})]}):Object(R.jsx)(u.a,{to:"/auth"})})})},bt=Object(be.a)((function(e){return{appBar:{display:"flex",borderRadius:15,alignItems:"center",justifyContent:"center",flexDirection:"row"},heading:{color:"rgba(0, 183, 255,1)"}}})),ft=function(){var e=bt();return Object(R.jsx)(l.a,{children:Object(R.jsxs)(d.a,{maxWidth:"lg",children:[Object(R.jsx)(p.a,{className:e.appBar,position:"static",color:"inherit",children:Object(R.jsx)(m.a,{variant:"h2",align:"center",children:"B\xe0i \u0111\u0103ng"})}),Object(R.jsxs)(u.d,{children:[Object(R.jsx)(u.b,{path:"/",exact:!0,component:jt}),Object(R.jsx)(u.b,{path:"/auth",exact:!0,component:se})]})]})})},xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{authData:null,isLoading:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0});case Y:return Object(b.a)(Object(b.a)({},e),{},{isLoading:!1});case A:return localStorage.setItem("profile",JSON.stringify(Object(b.a)({},null===t||void 0===t?void 0:t.data))),Object(b.a)(Object(b.a)({},e),{},{authData:null});case W:return localStorage.clear(),Object(b.a)(Object(b.a)({},e),{},{authData:null});default:return e}},ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{newPost:{},isLoading:!1,posts:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0});case Y:return Object(b.a)(Object(b.a)({},e),{},{isLoading:!1});case G:return Object(b.a)(Object(b.a)({},e),{},{newPost:t.payload});case V:return Object(b.a)(Object(b.a)({},e),{},{posts:t.payload});case J:return e.posts.unshift(t.payload),Object(b.a)({},e);case U:case H:return Object(b.a)(Object(b.a)({},e),{},{posts:e.posts.map((function(e){return e._id===t.payload._id?t.payload:e}))});case M:return Object(b.a)(Object(b.a)({},e),{},{posts:e.posts.filter((function(e){return e._id!==t.payload}))});default:return e}},Ot=Object(s.b)({auth:xt,posts:ht}),gt=Object(s.d)(Ot,Object(s.c)(Object(s.a)(i.a)));r.a.render(Object(R.jsx)(o.a,{store:gt,children:Object(R.jsx)(ft,{})}),document.getElementById("root"))}},[[206,1,2]]]);
//# sourceMappingURL=main.dc14e6eb.chunk.js.map