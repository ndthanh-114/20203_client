(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{212:function(e,t,n){},213:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(14),r=n.n(o),c=n(16),s=n(62),l=n(117),d=n(65),u=n(18),p=n(255),m=n(259),b=n(215),f=n(43),j=n(7),x=n(8),h=n.n(x),O=n(11),g=n(10),v=n(254),y=n(251),C=n(214),S=n(264),k=n(249),w=n(256),_=n(125),N=n.n(_),P=n(246),I=Object(P.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:e.spacing(2)},root:{"& .MuiTextField-root":{margin:e.spacing(1)}},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)},googleButton:{marginBottom:e.spacing(2)}}})),T=n(260),E=n(252),D=n(253),F=n(122),L=n.n(F),z=n(123),A=n.n(z),M=n(1),R=function(e){var t=e.name,n=e.handleChange,i=e.label,a=e.autoFocus,o=e.type,r=e.handleShowPassword;return Object(M.jsx)(k.a,{item:!0,xs:12,sm:12,children:Object(M.jsx)(T.a,{name:t,onChange:n,variant:"outlined",required:!0,fullWidth:!0,label:i,autoFocus:a,type:o,InputProps:"password"===t?{endAdornment:Object(M.jsx)(E.a,{position:"end",children:Object(M.jsx)(D.a,{onClick:r,children:"password"===o?Object(M.jsx)(L.a,{}):Object(M.jsx)(A.a,{})})})}:null})})},B="AUTH",W="LOGOUT",U="CREATE",J="FETCH_ALL",H="DELETE",V="UPDATE",q="COMMENT",G="START_LOADING",K="NEW_POST",X="END_LOADING",Y="NOTIFICATION",$="CHILD_CLICKED",Q="CLEAN_NOTIFICATION",Z="DELETE_NOTIFICATION",ee="IS_COMMENT",te="SHOW_COMMENT",ne="UPDATE_CMT",ie="DELETE_POST",ae=n(124),oe=n.n(ae).a.create({baseURL:"https://thuc-tap-20203-1.herokuapp.com/"});oe.interceptors.request.use((function(e){return localStorage.getItem("profile")&&(e.headers.authorization="Bearer ".concat(JSON.parse(localStorage.getItem("profile")).token)),e}));var re=function(e,t){return oe.post("/signin",e).catch((function(e){return alert(e.response.data.message)}))},ce=function(e,t){return oe.post("/signup",e).catch((function(e){return alert(e.response.data.message)}))},se=function(e){return oe.get("/posts/".concat(e))},le=function(e,t){return oe.get("/posts/".concat(e,"/comment/").concat(t))},de=function(e){return oe.post("/posts",e)},ue=function(e){return oe.delete("/posts/".concat(e))},pe=function(e){return oe.patch("/posts/".concat(e,"/likePost"))},me=function(e,t){return function(){var n=Object(O.a)(h.a.mark((function n(i){var a,o;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i({type:G}),n.next=4,re(e);case 4:a=n.sent,(o=a.data).result.password=e.password,i({type:B,data:o}),i({type:X}),t.push("/"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),i({type:X}),console.log(n.t0.message);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e){return n.apply(this,arguments)}}()},be=function(e,t){return function(){var n=Object(O.a)(h.a.mark((function n(i){var a,o;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i({type:G}),n.next=4,ce(e);case 4:a=n.sent,(o=a.data).result.password=e.password,i({type:B,data:o}),i({type:X}),t.push("/"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),i({type:X}),console.log(n.t0.message);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e){return n.apply(this,arguments)}}()},fe=function(){var e=Object(c.c)((function(e){return e.auth})).isLoading,t=Object(i.useState)(!1),n=Object(g.a)(t,2),a=n[0],o=n[1],r=I(),s=Object(i.useState)({email:"",password:"",confirmPassword:""}),l=Object(g.a)(s,2),d=l[0],m=l[1],x=Object(i.useState)(!1),_=Object(g.a)(x,2),P=_[0],T=_[1],E=Object(u.g)(),D=Object(c.b)(),F=function(){var e=Object(O.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{D(a?be(d,E):me(d,E))}catch(n){E.push("/auth")}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(e){m(Object(j.a)(Object(j.a)({},d),{},Object(f.a)({},e.target.name,e.target.value)))};return e?Object(M.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(M.jsx)(v.a,{style:{color:"white"}})}):Object(M.jsx)(y.a,{in:!0,children:Object(M.jsx)(p.a,{component:"main",maxWidth:"xs",children:Object(M.jsxs)(C.a,{className:r.paper,elevation:3,children:[Object(M.jsx)(S.a,{className:r.avatar,children:Object(M.jsx)(N.a,{})}),Object(M.jsx)(b.a,{component:"h1",variant:"h5",children:a?"\u0110\u0103ng k\xfd":"\u0110\u0103ng nh\u1eadp"}),Object(M.jsxs)("form",{className:r.form,onSubmit:F,children:[Object(M.jsxs)(k.a,{container:!0,spacing:2,children:[Object(M.jsx)(R,{name:"email",label:"Email Address",handleChange:L,type:"email"}),Object(M.jsx)(R,{name:"password",label:"Password",handleChange:L,type:P?"text":"password",handleShowPassword:function(){return T(!P)}}),a&&Object(M.jsx)(R,{name:"confirmPassword",label:"Confirm Password",handleChange:L,type:"password"})]}),Object(M.jsx)(w.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:r.submit,children:a?"\u0110\u0103ng k\xfd":"\u0110\u0103ng nh\u1eadp"}),Object(M.jsx)(k.a,{container:!0,justifyContent:"flex-end",children:Object(M.jsx)(k.a,{item:!0,children:Object(M.jsx)(w.a,{onClick:function(){o((function(e){return!e})),T(!1)},children:a?"\u0110\xe3 c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng nh\u1eadp":"Ch\u01b0a c\xf3 t\xe0i kho\u1ea3n? \u0110\u0103ng k\xfd"})})})]})]})})})},je=Object(P.a)((function(e){return{posts:{marginTop:"40px"},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:e.spacing(2)},root:{"& .MuiTextField-root":{margin:e.spacing(1)}},form:{width:"100%",marginTop:e.spacing(3)}}})),xe=function(e,t){return function(){var n=Object(O.a)(h.a.mark((function n(i){var a,o;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e=Object(j.a)(Object(j.a)({},e),{},{message:t}),n.next=4,de(e);case 4:return a=n.sent,(o=a.data).lengCmt=0,i({type:U,payload:o}),n.abrupt("return",o);case 11:n.prev=11,n.t0=n.catch(0),alert("".concat(n.t0.response.data.message)),localStorage.clear(),i({type:B});case 16:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()},he=function(e,t){return function(){var n=Object(O.a)(h.a.mark((function n(i){return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ue(e);case 3:i({type:H,payload:{id:e,indexPost:t}}),n.next=11;break;case 6:n.prev=6,n.t0=n.catch(0),alert("".concat(n.t0.response.data.message)),localStorage.clear(),i({type:B});case 11:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(e){return n.apply(this,arguments)}}()},Oe=function(e,t){return function(){var n=Object(O.a)(h.a.mark((function n(i){var a,o;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,pe(e);case 3:return a=n.sent,(o=a.data).lengCmt=t,i({type:V,payload:o}),n.abrupt("return",o);case 10:n.prev=10,n.t0=n.catch(0),alert("B\xe0i vi\u1ebft kh\xf4ng kh\u1ea3 d\u1ee5ng"),localStorage.clear(),i({type:B});case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()},ge=Object(P.a)((function(e){return{profile:{padding:"5px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",positon:"fixed"},txt:{marginBottom:"5px"},options:{display:"flex",justifyContent:"space-around"},icon:{color:"rgb(0,0,0,0.8)",padding:"13px",background:"rgb(0,255,255,0.4)",borderRadius:"50%","&:hover":{background:"rgb(0,255,255,0.5)",cursor:"pointer"}},notifi:{color:"red"}}})),ve=function(e){var t,n,i=e.user,a=e.handleLogout,o=ge();return Object(M.jsx)("div",{className:o.root_profile,children:Object(M.jsxs)(C.a,{style:{margin:"10px"},className:o.profile,children:[Object(M.jsx)("div",{className:o.txt,children:"Email: ".concat(null===i||void 0===i||null===(t=i.result)||void 0===t?void 0:t.email)}),Object(M.jsx)("div",{className:o.txt,children:"M\u1eadt kh\u1ea9u: ".concat(null===i||void 0===i||null===(n=i.result)||void 0===n?void 0:n.password)}),Object(M.jsx)(w.a,{onClick:a,color:"secondary",variant:"contained",children:"\u0110\u0103ng xu\u1ea5t"})]})})},ye=n(70),Ce=n(217),Se=Object(Ce.a)((function(e){return{post:{width:"100%",marginTop:"15px",padding:"5px"},newPost:{animation:"$myEffect 3000ms"},"@keyframes myEffect":{"0%":{opacity:0,transform:"translateY(-200%)"},"100%":{opacity:1,transform:"translateY(0)"}},post__top:{display:"flex",position:"relative",alignItems:"center",padding:"0 5px"},post__topInfo:{display:"flex",flex:"1",alignItems:"flex-start",flexDirection:"column"},post__delete:{"&:hover":{borderRadius:"999px",backgroundColor:"lightwhite",cursor:"pointer"}},h3__topInfo:{fontSize:"large"},date:{fontSize:"0.9rem",color:"gray"},post__avatar:{marginRight:"10px"},body:{padding:"0 10px 5px 10px"},post__image:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",background:"whitesmoke"},previousImage:{position:"absolute",cursor:"pointer",top:"45%",left:"0",padding:"5px"},nextImage:{position:"absolute",cursor:"pointer",top:"45%",right:"0",padding:"5px"},icon:{color:"black",opacity:"0.7"},haveImage:{flex:"0.7",width:"90%"},fileOther:{textDecoration:"none",color:"black",margin:"5px"},file:{backgroundColor:"#ADDCFF",textAlign:"center",borderRadius:"10px",padding:"2px"},post__options:{borderTop:"1px solid lightgray",display:"flex",justifyContent:"space-evenly",fontSize:"medium",color:"gray",cursor:"pointer",padding:"5px 5px 0 5px"},post__option:{display:"flex",alignItems:"center",justifyContent:"center",flex:"1","&:hover":{backgroundColor:"#eff2f5",borderRadius:"20px"}},comments:{marginTop:"5px",borderTop:"1px solid lightgray"},post__bottom:{marginTop:"5px",fontSize:"1.05em",wordWrap:"break-word","& img":{verticalAlign:"middle"}}}})),ke=n(88),we=n.n(ke),_e=n(128),Ne=n.n(_e),Pe=n(132),Ie=n.n(Pe),Te=n(133),Ee=n.n(Te),De=n(126),Fe=n.n(De),Le=n(129),ze=n.n(Le),Ae=n(130),Me=n.n(Ae),Re=n(131),Be=n.n(Re),We=n(69),Ue=Object(P.a)((function(e){return{commentsOuterContainer:{padding:"5px",display:"flex",alignItems:"stretch",flexDirection:"column"},commentsInnerContainer:{margin:"5px 0",display:"flex",flexDirection:"column",alignItems:"flex-start"},form___comment:{display:"flex",borderRadius:"20px"},input__comment:{flex:"1",fontSize:"medium",padding:"10px",border:"none",borderRadius:"15px",backgroundColor:"whitesmoke !important",resize:"none",outline:"none"},list__comment:{padding:"5px 10px",borderRadius:"15px",backgroundColor:"whitesmoke",wordWrap:"break-word"},emoji:{"& img":{verticalAlign:"middle !important"}}}})),Je=Object(P.a)((function(e){return{form___comment:{display:"flex",borderRadius:"20px"},input__comment:{flex:"1",fontSize:"medium",padding:"10px",border:"none",borderRadius:"15px",backgroundColor:"whitesmoke",resize:"none",outline:"none"},list__comment:{padding:"5px 10px",borderRadius:"15px",backgroundColor:"whitesmoke",wordWrap:"break-word"},emojiSub:{"& img":{verticalAlign:"middle !important"}}}})),He=n(17),Ve=n.n(He),qe=n(58),Ge=function(e){var t,n=e.post,a=e.indexPost,o=e.c,r=(e.setNewSubCmtToSocket,e.setSubCommentToSocket,e.subCommentToSocket),c=e.i,s=e.socket,l=e.idPost,d=e.email,u=e.isShowSubComments,p=(e.setIsShowSubComments,Object(i.useState)(!1)),m=Object(g.a)(p,2),f=m[0],j=m[1],x=Object(i.useState)(""),h=Object(g.a)(x,2),O=h[0],y=h[1],C=Je();Object(i.useEffect)((function(){if(r&&u[c]&&s&&String(r.idPost)===String(null===n||void 0===n?void 0:n._id)&&String(r.prevCommentId)===String(o._id)&&String(r.index)===String(c)){var e=r.data,t=r.prevCommentId,i=r.totalSubcomment,a=r._id;if(n.subComments||n.subComments===[]){for(var d=!1,p=0;p<n.subComments.length;p++)if(String(n.subComments[p]._id)===String(a)){d=!0;break}d||n.subComments&&(n.subComments.push({data:e,prevCommentId:t,totalSubcomment:i,_id:a}),s.emit("increSubCmt",{idPost:l,i:c,idComment:o._id,idSubCmt:r._id},(function(){})))}}}),[r]);var S=function(e){if(j(!0),O&&""!==O.trim()){var t=o._id;s.emit("send subComment",{email:d,idPost:l,data:O,prevId:t,i:c},(function(e){var n;e&&alert(e),y(""),j(!1),s.emit("send interaction",{email:d,idPost:l,data:O,prevId:t,indexPost:a,dataCmtPrev:null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.split("::: ")[1],idCmtPrev:o._id,type:"SUB_COMMENT",indexOfSubCmt:c},(function(e){e&&alert(e)}))}))}};return u[c]&&Object(M.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"5px 0"},children:[null===n||void 0===n||null===(t=n.subComments)||void 0===t?void 0:t.map((function(e){var t,n;return Object(M.jsxs)(b.a,{className:C.list__comment,variant:"subtitle2",style:{margin:"0 auto 0 50px"},children:[Object(M.jsx)("strong",{children:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.split("::: ")[0]}),Object(M.jsx)("div",{className:C.emojiSub,children:Ve.a.emojify(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.split("::: ")[1])})]},e._id)})),Object(M.jsxs)("form",{className:C.form___comment,style:{margin:"0 0 0 48px"},onSubmit:S,children:[Object(M.jsx)(qe.a,{disabled:f,style:{backgroundColor:"whitesmoke"},value:O,onChange:y,cleanOnEnter:!0,onEnter:S,name:"subComment",placeholder:"Vi\u1ebft b\xecnh lu\u1eadn"}),Object(M.jsx)("button",{type:"submit",hidden:!0,children:"Send"}),f&&Object(M.jsx)(v.a,{})]})]})},Ke=function(e){var t,n,a=e.post,o=e.subCommentToSocket,r=e.setSubCommentToSocket,c=e.showSubCmt,s=e.setNewSubCmtToSocket,l=(e.handleShowComment,e.indexPost),d=e.socket,u=e.handleDelete,p=(e.opened,e.isLoadingComment),m=(e.setIsLoadingComment,JSON.parse(localStorage.getItem("profile"))),f=Object(i.useState)(""),j=Object(g.a)(f,2),x=j[0],y=j[1],C=Object(i.useState)(!1),S=Object(g.a)(C,2),k=S[0],w=S[1],_=Object(i.useState)(!1),N=Object(g.a)(_,2),P=N[0],I=N[1],T=Object(i.useState)([]),E=Object(g.a)(T,2),D=E[0],F=E[1],L=Ue(),z=null===m||void 0===m||null===(t=m.result)||void 0===t?void 0:t.email,A=a._id;Object(i.useEffect)((function(){var e;F([]),e=Array(null===a||void 0===a?void 0:a.comments.length).fill(!1),D.push.apply(D,Object(We.a)(e))}),[]),Object(i.useEffect)((function(){D[null===c||void 0===c?void 0:c.indexOfSubCmt]||W(null===c||void 0===c?void 0:c.indexOfSubCmt,null===c||void 0===c?void 0:c.idCmtPrev)}),[c]);var R=function(){var e=Object(O.a)(h.a.mark((function e(t,n){var i,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(A,n);case 2:return i=e.sent,a=i.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),B=function(){var e=Object(O.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I(!0),x&&""!==x.trim()&&("",d.emit("send comment",{email:z,idPost:A,data:x,prevId:"",indexPost:l},(function(e){e&&(alert(e),u()),y(""),I(!1),d.emit("send interaction",{email:z,idPost:A,data:x,prevId:"",indexPost:l,type:"COMMENT"},(function(e){e&&alert(e)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(O.a)(h.a.mark((function e(t,n){var i,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t>=D.length&&(i=Array(t-D.length+1).fill(!1),F(D.push.apply(D,Object(We.a)(i)))),e.prev=1,e.next=4,F(null===D||void 0===D?void 0:D.map((function(e,n){return n===t&&!e})));case 4:return w(!0),k=!0,e.next=8,R(t,n);case 8:o=e.sent,a.subComments=o,e.next=14;break;case 12:e.prev=12,e.t0=e.catch(1);case 14:return e.prev=14,w(!1),k=!1,e.finish(14);case 18:case"end":return e.stop()}}),e,null,[[1,12,14,18]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(M.jsx)("div",{children:Object(M.jsxs)("div",{className:L.commentsOuterContainer,children:[p?Object(M.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(M.jsx)(v.a,{})}):Object(M.jsx)(M.Fragment,{children:Object(M.jsx)("div",{className:L.commentsInnerContainer,children:null===a||void 0===a||null===(n=a.comments)||void 0===n?void 0:n.map((function(e,t){var n,i;return Object(M.jsxs)("div",{style:{padding:"5px 10px",display:"flex",flexDirection:"column",width:"95%"},children:[Object(M.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0 10px"},children:[Object(M.jsxs)(b.a,{gutterBottom:!0,variant:"subtitle2",className:L.list__comment,children:[Object(M.jsx)("strong",{children:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.split("::: ")[0]}),Object(M.jsx)("div",{className:L.emoji,children:Ve.a.emojify(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.split("::: ")[1])})]}),(null===e||void 0===e?void 0:e.totalSubcomment)<=0&&Object(M.jsx)(b.a,{variant:"body2",onClick:function(){var n=e._id;W(t,n)},style:{width:"130px",cursor:"pointer",display:"flex",justifyContent:"start",fontSize:"0.8rem"},children:"Tr\u1ea3 l\u1eddi"})]}),(null===e||void 0===e?void 0:e.totalSubcomment)>0&&Object(M.jsx)(b.a,{variant:"body2",onClick:function(){var n=e._id;W(t,n)},style:{cursor:"pointer",display:"flex",padding:"0px 5px",fontSize:"0.8rem"},color:"primary",children:D[t]?"Thu g\u1ecdn":"".concat(e.totalSubcomment," l\u01b0\u1ee3t ph\u1ea3n h\u1ed3i")}),D[t]?k?Object(M.jsx)(v.a,{fontSize:"small"}):Object(M.jsx)(Ge,{post:a,c:e,i:t,indexPost:l,email:z,idPost:A,setNewSubCmtToSocket:s,socket:d,subCommentToSocket:o,isShowSubComments:D,openedSubCmt:k,setIsShowSubComments:F,setSubCommentToSocket:r},t):null]},t)}))})}),Object(M.jsxs)("form",{className:L.form___comment,onSubmit:B,children:[Object(M.jsx)(qe.a,{disabled:P||p,style:{backgroundColor:"whitesmoke"},value:x,onChange:y,cleanOnEnter:!0,onEnter:B,name:"comment",placeholder:"Vi\u1ebft b\xecnh lu\u1eadn"}),Object(M.jsx)("button",{type:"submit",hidden:!0,children:"Send"}),P&&Object(M.jsx)(v.a,{})]})]})})},Xe=n(127),Ye=n.n(Xe),$e=["data","prevCommentId","totalSubcomment","_id"],Qe=["i"],Ze=function(e){var t,n=e.post,a=e.socket,o=e.newSubCmtToSocket,r=e.setSubCommentToSocket,s=e.setCommentToSocket,l=e.setNewSubCmtToSocket,d=e.subCommentToSocket,u=e.indexPost,p=e.selected,m=e.refProp,b=e.commentToSocket,f=Object(i.useState)(!1),x=Object(g.a)(f,2),y=x[0],k=x[1],w=Object(i.useState)(!1),_=Object(g.a)(w,2),N=_[0],P=_[1],I=Object(i.useState)(!1),T=Object(g.a)(I,2),E=T[0],D=T[1],F=Object(i.useState)(!1),L=Object(g.a)(F,2),z=L[0],A=L[1],R=Object(i.useState)(!1),B=Object(g.a)(R,2),W=B[0],U=B[1],J=Se(),H=Object(c.b)(),V=JSON.parse(localStorage.getItem("profile")),q=Object(i.useState)(0),G=Object(g.a)(q,2),K=G[0],X=G[1],Y=Object(i.useState)(0),Q=Object(g.a)(Y,2),ne=Q[0],ie=Q[1],ae=Object(c.c)((function(e){return e.posts})),oe=ae.newPost,re=ae.isComments,ce=ae.showComment,le=ae.childClicked,de=ae.notifications,ue=Object(i.useState)(null),pe=Object(g.a)(ue,2),me=pe[0],be=pe[1];Object(i.useEffect)((function(){var e;p&&(null===m||void 0===m||null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"}),H({type:$,payload:-1}))}),[le,H,m,p]),Object(i.useEffect)((function(){if(ce&&(null===ce||void 0===ce?void 0:ce.indexPost)===u){if(re[u]||ke(),"number"==typeof(null===ce||void 0===ce?void 0:ce.indexOfSubCmt)&&-1!==(null===ce||void 0===ce?void 0:ce.indexOfSubCmt)){var e=ce.indexOfSubCmt,t=ce.idCmtPrev;be({indexOfSubCmt:e,idCmtPrev:t})}H({type:te,payload:null})}}),[ce]),Object(i.useEffect)((function(){if(b&&String(b.idPost)===String(null===n||void 0===n?void 0:n._id)){var e=b.data,t=b.prevCommentId,i=b.totalSubcomment,a=b._id,o=Object(ye.a)(b,$e);console.log(o),n.comments.push({data:e,prevCommentId:t,totalSubcomment:i,_id:a}),n.lengCmt||(n.lengCmt=0),n.lengCmt+=1,s(Object(j.a)(Object(j.a)({},b),{},{idPost:""}))}}),[b]),Object(i.useEffect)((function(){if(o.i!==Number(-1)&&String(o.idPost)===String(null===n||void 0===n?void 0:n._id)){var e=o.i,t=Object(ye.a)(o,Qe);console.log(t),n.lengCmt||(n.lengCmt=0),n.lengCmt+=1,N&&(n.comments[Number(e)].totalSubcomment+=1),-1!==o.i&&l({idPost:"",i:-1,idComment:"",idSubCmt:o.idSubCmt})}}),[o]);var fe=[],je=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k(!0),de.forEach((function(e,t){e.idPost===n._id&&H({type:Z,payload:t})})),e.next=5,H(he(n._id,u));case 5:k(!1),a.emit("deleted post",{creatorPostDeleted:n.creator,indexPostDeleted:u,idPostDeleted:n._id,dataDeleted:n.message},(function(){})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),k(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e;if(n.selectedFile.length>0&&(fe=n.selectedFile.filter((function(e){return e.type.includes("image")})),X(fe.length),fe.length>0))return Object(M.jsx)("img",{alt:"",className:J.haveImage,src:null===(e=fe[ne])||void 0===e?void 0:e.base64});return!1},ge=function(){return n.selectedFile.length>0&&Object(M.jsx)(M.Fragment,{children:n.selectedFile.map((function(e){return e.type.includes("image")?null:Object(M.jsx)("a",{className:J.fileOther,title:e.name,href:e.base64,download:e.name,children:Object(M.jsx)("div",{className:J.file,children:e.name},e.name)},e.name)}))})},ve=function(){return n.likes.length>0&&n.likes.find((function(e){var t;return e===(null===V||void 0===V||null===(t=V.result)||void 0===t?void 0:t.email)}))?Object(M.jsx)(M.Fragment,{children:Object(M.jsx)(Ne.a,{style:{color:"blue"}})}):Object(M.jsx)(M.Fragment,{children:Object(M.jsx)(we.a,{})})},Ce=function(){var e=Object(O.a)(h.a.mark((function e(){var t,i,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,A(!0),e.next=4,H(Oe(n._id,n.lengCmt));case 4:t=e.sent,i=t.likes.find((function(e){var t;return e===(null===V||void 0===V||null===(t=V.result)||void 0===t?void 0:t.email)})),a&&a.emit("send likeInteraction",{email:null===V||void 0===V||null===(o=V.result)||void 0===o?void 0:o.email,indexPost:u,idPost:n._id,title:n.message,data:t,isLike:i},(function(e){e&&alert(e)})),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:return e.prev=11,A(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,9,11,14]])})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=Object(O.a)(h.a.mark((function e(){var t,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N){e.next=16;break}return U(!0),e.prev=2,D(!0),e.next=6,se(n._id);case 6:t=e.sent,(i=t.data)&&(n.comments=i,P(!0),D(!1)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0),D(!1);case 15:U(!1);case 16:H({type:ee,payload:u});case 17:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(C.a,{className:Ye()(J.post,oe.is&&(null===oe||void 0===oe?void 0:oe.postId)===n._id?J.newPost:null),children:[Object(M.jsxs)("div",{className:J.post__top,children:[Object(M.jsx)(S.a,{className:J.post__avatar,children:n.creator[0]}),Object(M.jsxs)("div",{className:J.post__topInfo,children:[Object(M.jsx)("div",{className:J.h3__topInfo,children:n.creator}),Object(M.jsx)("div",{className:J.date,children:Fe()(n.createdAt).format("L")})]}),(null===V||void 0===V||null===(t=V.result)||void 0===t?void 0:t.email)===n.creator&&Object(M.jsx)("div",{className:J.post__delete,onClick:je,children:Object(M.jsx)(ze.a,{})})]}),y?Object(M.jsxs)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:[Object(M.jsx)(v.a,{}),"\u0110ang x\xf3a"]}):Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("div",{className:J.body,children:[Object(M.jsx)("div",{className:J.post__bottom,children:Ve.a.emojify(n.message)}),Object(M.jsxs)("div",{className:J.post__image,children:[n.selectedFile&&Object(M.jsx)(xe,{}),K>1&&Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{onClick:function(){ie(0===ne?fe.length-1:ne-1)},className:J.previousImage,children:Object(M.jsx)(Me.a,{className:J.icon})}),Object(M.jsx)("div",{onClick:function(){ne===fe.length-1?ie(0):ie(ne+1)},className:J.nextImage,children:Object(M.jsx)(Be.a,{className:J.icon})})]})]}),Object(M.jsx)("div",{className:J.post__file,style:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:n.selectedFile&&Object(M.jsx)(ge,{})})]}),Object(M.jsxs)("div",{className:J.post__options,children:[z?Object(M.jsx)("div",{className:J.post__option,children:Object(M.jsx)(v.a,{})}):Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)("div",{className:J.post__option,onClick:Ce,children:[Object(M.jsx)(ve,{}),Object(M.jsxs)("p",{style:{marginLeft:"10px"},children:[n.likes.length," Th\xedch"]})]})}),Object(M.jsxs)("div",{className:J.post__option,onClick:ke,children:[Object(M.jsx)(Ie.a,{}),Object(M.jsxs)("p",{style:{marginLeft:"10px"},children:[" ",n.lengCmt," B\xecnh lu\u1eadn"]})]}),Object(M.jsxs)("div",{className:J.post__option,children:[Object(M.jsx)(Ee.a,{}),Object(M.jsx)("p",{style:{marginLeft:"10px"},children:"Chia s\u1ebb"})]})]}),W&&Object(M.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(M.jsx)(v.a,{})}),re[u]&&Object(M.jsx)("div",{className:J.comments,children:Object(M.jsx)(Ke,{subCommentToSocket:d,setNewSubCmtToSocket:l,post:n,setIsLoadingComment:D,opened:N,isLoadingComment:E,socket:a,handleDelete:je,indexPost:u,handleShowComment:ke,showSubCmt:me,setSubCommentToSocket:r})})]})]},n._id)})},et=Object(P.a)((function(e){return{createPost:{padding:"5px",display:"flex",flexDirection:"column",width:"100%"},header__createPost:{display:"flex",flexDirection:"row",borderBottom:"1px solid #eff2f5",padding:"5px",alignItems:"center"},form___createPost:{flex:"1",display:"flex"},input__createPost:{outlineWidth:"0",border:"none",padding:"10px 20px",margin:"0 10px",borderRadius:"999px",backgroundColor:"#eff2f5",flex:"1",fontSize:"1.05rem"},options__createPost:{display:"flex",justifyContent:"space-evenly"},option:{padding:"5px",display:"flex",alignItems:"center",justifyContent:"center",flex:"0.33",color:"gray",cursor:"pointer","&:hover":{backgroundColor:"#eff2f5",borderRadius:"20px"}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"10px",boxShadow:e.shadows[5]}}})),tt=n(136),nt=n.n(tt),it=n(137),at=n.n(it),ot=n(138),rt=n.n(ot),ct=n(261),st=n(257),lt=n(216),dt=Object(P.a)((function(e){return{form:{padding:"5px",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},header:{width:"100%",fontSize:"medium",fontWeight:"bold",padding:"5px 0",textAlign:"center",borderBottom:"1px solid gray",display:"block"},body:{padding:"5px",display:"flex",flexDirection:"column",width:"100%"},top:{display:"flex",flexDirection:"flex-start",padding:"5px 0"},avatar:{marginRight:"5px"},info:{},detail:{display:"flex",alignItems:"center"},input_text:{padding:"10px",fontSize:"1.05rem",border:"none",backgroundColor:"whitesmoke",resize:"none",outline:"none"},image:{display:"flex",flexDirection:"column"},submit:{margin:"5px"},prevImage:{position:"relative"},closeImage:{position:"absolute",fontSize:"large",color:"blue",backgroundColor:"white",right:"10px",top:"5px",borderRadius:"50%",cursor:"pointer"},prevFile:{backgroundColor:"#ADDCFF",position:"relative",padding:"5px 35px 5px 10px",borderRadius:"20px",margin:"5px 5px 5px 0"},closeForm:{position:"absolute",padding:"0 5px",right:"0px",cursor:"pointer"},paper:{backgroundColor:e.palette.background.paper,borderRadius:"10px",boxShadow:e.shadows[5],width:"50%"},filebase:{color:"blue",display:"none"},form__bottom:{display:"flex",marginTop:"5px",justifyContent:"space-between"}}})),ut=n(134),pt=n.n(ut),mt=n(135),bt=n.n(mt),ft=n(79),jt=n.n(ft),xt=0,ht=function(e){var t,n,a,o=e.user,r=e.setOpen,s=e.socket,l=Object(i.useState)(""),d=Object(g.a)(l,2),u=d[0],p=d[1],m=Object(c.c)((function(e){return e.posts})).notifications,b=Object(i.useState)({message:"",creator:null===o||void 0===o||null===(t=o.result)||void 0===t?void 0:t.email,selectedFile:[]}),f=Object(g.a)(b,2),x=f[0],y=f[1],C=Object(i.useState)(!1),k=Object(g.a)(C,2),_=k[0],N=k[1],P=Object(i.useState)(!1),I=Object(g.a)(P,2),T=I[0],E=I[1],D=Object(c.b)(),F=dt();Object(i.useEffect)((function(){x.selectedFile.forEach((function(e){"kB"===e.size.split(" ")[1]?xt+=Number(e.size.split(" ")[0]):xt+=1024*Number(e.size.split(" ")[0])})),N(xt>1e3),xt=0}),[x.selectedFile]);var L=function(e){var t=x.selectedFile.filter((function(t){return t.name!==e}));y(Object(j.a)(Object(j.a)({},x),{},{selectedFile:t}))},z=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,y(Object(j.a)(Object(j.a)({},x),{},{message:u}));case 3:return e.prev=3,E(!0),e.next=7,D(xe(x,u));case 7:n=e.sent,r(!1),m.forEach((function(e,t){e.indexPost+=1})),E(!1),i=null===n||void 0===n?void 0:n._id,p(""),s.emit("newPost",{postId:i},(function(){})),e.next=22;break;case 16:e.prev=16,e.t0=e.catch(3),r(!1),p(""),E(!1),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(M.jsx)(M.Fragment,{children:T?Object(M.jsx)("div",{style:{display:"flex",placeItems:"center"},children:Object(M.jsx)(v.a,{})}):Object(M.jsx)("div",{className:F.paper,children:Object(M.jsxs)("form",{autoComplete:"off",noValidate:!0,className:F.form,onSubmit:z,children:[Object(M.jsx)("div",{className:F.header,children:"T\u1ea1o b\xe0i vi\u1ebft"}),Object(M.jsxs)("div",{className:F.body,children:[Object(M.jsxs)("div",{className:F.top,children:[Object(M.jsx)(S.a,{className:F.avatar,children:null===o||void 0===o||null===(n=o.result)||void 0===n?void 0:n.email[0]}),Object(M.jsxs)("div",{className:F.info,children:[Object(M.jsx)("div",{style:{fontWeight:"bold"},children:null===o||void 0===o||null===(a=o.result)||void 0===a?void 0:a.email}),Object(M.jsxs)("div",{className:F.detail,children:[Object(M.jsx)(bt.a,{style:{fontSize:"medium"}}),Object(M.jsx)("div",{style:{marginLeft:"5px",fontSize:"0.9rem",color:"gray"},children:"B\u1ea1n b\xe8"})]})]})]}),Object(M.jsxs)("div",{className:"main-create-form",children:[Object(M.jsx)(qe.a,{style:{backgroundColor:"whitesmoke"},value:u,onChange:p,name:"content",placeholder:"B\u1ea1n \u0111ang ngh\u0129 g\xec th\u1ebf?"}),Object(M.jsxs)("div",{className:F.image,children:[Object(M.jsx)("div",{style:{display:"flex",overflow:"auto",width:"100%"},children:x.selectedFile.map((function(e){return e.type.includes("image")?Object(M.jsxs)("div",{className:F.prevImage,children:[Object(M.jsx)("img",{src:e.base64,style:{height:"100px",marginRight:"5px",objectFit:"contain"},alt:""}),Object(M.jsx)(jt.a,{className:F.closeImage,onClick:function(){return L(e.name)}})]},e.name):null}))}),Object(M.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",width:"485px"},children:x.selectedFile.map((function(e){return e.type.includes("image")?null:Object(M.jsxs)("div",{className:F.prevFile,children:[e.name,Object(M.jsx)(jt.a,{className:F.closeImage,onClick:function(){return L(e.name)}})]},e.name)}))}),!x.selectedFile.length&&Object(M.jsxs)("div",{className:F.form__bottom,children:[Object(M.jsx)("div",{style:{fontSize:"medium"},children:"Th\xeam t\u1ec7p"}),Object(M.jsx)(pt.a,{className:F.filebase,name:"selectedFile",type:"file",multiple:!0,onDone:function(e){return y(Object(j.a)(Object(j.a)({},x),{},{selectedFile:e}))}})]})]})]})]}),_&&Object(M.jsx)("div",{style:{color:"red",fontStyle:"italic",margin:"5px"},children:"V\u01b0\u1ee3t qu\xe1 k\xedch th\u01b0\u1edbc cho ph\xe9p"}),Object(M.jsx)(w.a,{disabled:""===u.trim()&&0===x.selectedFile.length||_,type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:F.submit,children:"\u0110\u0103ng"}),Object(M.jsx)(jt.a,{className:F.closeForm,onClick:function(){return r(!1)}})]})})})},Ot=function(e){var t,n=e.user,a=e.socket,o=Object(i.useState)(!1),r=Object(g.a)(o,2),c=r[0],s=r[1],l=et();return Object(M.jsxs)(C.a,{className:l.createPost,children:[Object(M.jsxs)("div",{className:l.header__createPost,children:[Object(M.jsx)(S.a,{children:null===n||void 0===n||null===(t=n.result)||void 0===t?void 0:t.email[0]}),Object(M.jsx)("form",{className:l.form___createPost,children:Object(M.jsx)("input",{readOnly:!0,onClick:function(){s(!0)},className:l.input__createPost,type:"text",placeholder:"B\u1ea1n \u0111ang ngh\u0129 g\xec?"})})]}),Object(M.jsxs)("div",{className:l.options__createPost,children:[Object(M.jsxs)("div",{className:l.option,children:[Object(M.jsx)(nt.a,{style:{color:"red"}}),Object(M.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"Video tr\u1ef1c ti\u1ebfp"})]}),Object(M.jsxs)("div",{className:l.option,children:[Object(M.jsx)(at.a,{style:{color:"green"}}),Object(M.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"\u1ea2nh/Video"})]}),Object(M.jsxs)("div",{className:l.option,children:[Object(M.jsx)(rt.a,{style:{color:"orange"}}),Object(M.jsx)("h3",{style:{fontSize:"medium",marginLeft:"10px"},children:"C\u1ea3m x\xfac/Ho\u1ea1t \u0111\u1ed9ng"})]})]}),c&&Object(M.jsx)(ct.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:l.modal,open:c,closeAfterTransition:!0,BackdropComponent:st.a,BackdropProps:{timeout:500},children:Object(M.jsx)(lt.a,{in:c,children:Object(M.jsx)(ht,{user:n,setOpen:s,socket:a})})})]})},gt=n(139),vt=n(140),yt=n.n(vt),Ct=n(263),St=n(262),kt=Object(P.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}})),wt=function(e){var t=e.socket,n=e.getRefs,a=kt(),o=Object(c.b)(),r=Object(c.c)((function(e){return e.posts})),s=r.newPost,l=r.notifications;Object(i.useEffect)((function(){return t&&t.on("notification",function(){var e=Object(O.a)(h.a.mark((function e(t){var i,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.error,a=t.post,i&&alert(i),!a){e.next=10;break}return e.next=5,o({type:K,payload:{is:!0,postId:null===a||void 0===a?void 0:a._id,postEmail:null===a||void 0===a?void 0:a.creator}});case 5:return e.next=7,o({type:U,payload:a});case 7:return l.forEach((function(e,t){e.indexPost+=1})),e.next=10,n();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){t&&t.off("notification")}}),[o,t]);var d=function(e,t){"clickaway"!==t&&o({type:K,payload:{is:!1,postId:null}})};return Object(M.jsx)("div",{className:a.root,children:Object(M.jsx)(Ct.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:s.is,autoHideDuration:3e3,onClose:d,children:Object(M.jsx)(St.a,{onClose:d,severity:"success",elevation:6,variant:"filled",children:s.postEmail&&"".concat(null===s||void 0===s?void 0:s.postEmail," c\xf3 b\xe0i \u0111\u0103ng m\u1edbi")})})})},_t=n(258),Nt=n(6),Pt=n.p+"static/media/bell.7f6b1105.gif",It=Object(P.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2),zIndex:12},image:Object(f.a)({borderRadius:"50%",height:"60px",border:"2px solid lightgray"},e.breakpoints.down("xs"),{height:"40px"}),hidden:{position:"fixed",bottom:e.spacing(-50),right:e.spacing(-50)}}})),Tt=Object(P.a)((function(e){var t;return{root:(t={position:"fixed",bottom:e.spacing(12),right:e.spacing(3),border:"2px solid lightgray",maxWidth:"400px",background:"whitesmoke",borderRadius:"6px",maxHeight:"500px",overflow:"auto",zIndex:14},Object(f.a)(t,e.breakpoints.down("xs"),{bottom:e.spacing(9)}),Object(f.a)(t,"animation","$myEffect 1000ms"),t),"@keyframes myEffect":{"0%":{opacity:0,transform:"translateX(100%)"},"100%":{opacity:1,transform:"translateX(0)"}},notification:{padding:"10px","&:hover":{background:"lightgray",cursor:"pointer"}},truncate:{maxWidth:"60px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},customSpan:{"& span":{fontWeight:"bold"},"& span img":{verticalAlign:"middle"}}}})),Et=function(e){var t=e.open,n=e.notifications,i=Tt(),a=Object(c.b)(),o=Object(c.c)((function(e){return e.posts})).isComments;return t?Object(M.jsx)("div",{className:i.root,children:n.map((function(e,t){return Object(M.jsxs)("div",{onClick:function(){a({type:$,payload:null===e||void 0===e?void 0:e.indexPost}),a({type:Z,payload:t}),"COMMENT"===e.type?o[t]||a({type:te,payload:{indexPost:Number(null===e||void 0===e?void 0:e.indexPost),indexOfSubCmt:Number(e.indexOfSubCmt),idCmtPrev:e.idCmtPrev}}):"SUB_COMMENT"===e.type?a({type:te,payload:{indexPost:Number(null===e||void 0===e?void 0:e.indexPost),indexOfSubCmt:Number(e.indexOfSubCmt),idCmtPrev:e.idCmtPrev}}):e.type},className:i.notification,children:["COMMENT"===e.type?Object(M.jsxs)("div",{className:i.customSpan,children:[Object(M.jsx)("strong",{children:e.email})," \u0111\xe3 b\xecnh lu\u1eadn b\xe0i vi\u1ebft \xa0",Object(M.jsx)("span",{children:e.title.length>=10?":"!==e.title[9]?Ve.a.emojify(e.title.substring(0,10)+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(e.title.substring(0,9)+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(e.title,{attributes:{width:"18px",height:"18px"}})}),"\xa0 m\xe0 b\u1ea1n \u0111\xe3 t\u01b0\u01a1ng t\xe1c"]}):"SUB_COMMENT"===e.type?Object(M.jsxs)("div",{className:i.customSpan,children:[Object(M.jsx)("strong",{children:e.email})," \u0111\xe3 ph\u1ea3n h\u1ed3i b\xecnh lu\u1eadn \xa0",Object(M.jsx)("span",{children:e.dataCmtPrev.trim().length>=10?":"!==e.dataCmtPrev[9]?Ve.a.emojify(e.dataCmtPrev.substring(0,10)+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(e.dataCmtPrev.substring(0,9)+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(e.dataCmtPrev,{attributes:{width:"18px",height:"18px"}})}),"\xa0 trong b\xe0i vi\u1ebft \xa0",Object(M.jsx)("span",{children:e.title.length>=10?":"!==e.title[9]?Ve.a.emojify(e.title.substring(0,10)+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(e.title.substring(0,9)+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(e.title,{attributes:{width:"18px",height:"18px"}})}),"\xa0 m\xe0 b\u1ea1n \u0111\xe3 t\u01b0\u01a1ng t\xe1c"]}):"LIKE"===e.type?Object(M.jsxs)("div",{className:i.customSpan,children:[Object(M.jsx)("strong",{children:e.email})," \u0111\xe3 th\xedch trong b\xe0i vi\u1ebft \xa0",Object(M.jsx)("span",{children:e.title.length>=10?":"!==e.title[9]?Ve.a.emojify(e.title.substring(0,10)+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(e.title.substring(0,9)+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(e.title,{attributes:{width:"18px",height:"18px"}})}),"\xa0 m\xe0 b\u1ea1n \u0111\xe3 t\u01b0\u01a1ng t\xe1c"]}):null,("COMMENT"===e.type||"SUB_COMMENT"===e.type)&&Object(M.jsx)(b.a,{gutterBottom:!0,variant:"body2",color:"primary",style:{marginTop:"5px",fontSize:"0.8rem",maxWidth:"350px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flex",alignSelf:"center"},children:Ve.a.emojify(e.data,{attributes:{width:"18px",height:"18px"}})})]},t)}))}):null},Dt=Object(Nt.a)((function(e){return{badge:{top:"15%",right:"10%",border:"2px solid lightgray",padding:"4px"}}}))(_t.a);function Ft(e){var t=e.socket,n=a.a.useState(!1),o=Object(g.a)(n,2),r=o[0],s=o[1],l=Object(c.c)((function(e){return e.posts})).notifications,d=Object(c.b)(),u=It();return Object(i.useEffect)((function(){return t&&t.on("interaction",(function(e){var t=e.error,n=e.title,i=e.email,a=e.data,o=e.idPost,r=e.indexPost,c=e.type,s=e.dataCmtPrev,l=e.indexOfSubCmt,u=e.idCmtPrev;t&&alert(t),"COMMENT"===c?d({type:Y,payload:{email:i,data:a,title:n,idPost:o,indexPost:r,type:c,dataCmtPrev:"",indexOfSubCmt:-1,idCmtPrev:""}}):"SUB_COMMENT"===c?d({type:Y,payload:{email:i,data:a,title:n,idPost:o,indexPost:r,type:c,dataCmtPrev:s,indexOfSubCmt:l,idCmtPrev:u}}):"LIKE"===c&&d({type:Y,payload:{email:i,data:a,title:n,idPost:o,indexPost:r,type:c,dataCmtPrev:"",indexOfSubCmt:-1,idCmtPrev:""}})})),function(){t&&t.off("interaction")}}),[d,t]),Object(i.useEffect)((function(){return t&&t.on("res like",(function(e){var t=e.data;d({type:V,payload:t})})),function(){t&&t.off("res like")}}),[d,t]),Object(i.useEffect)((function(){return t&&t.on("res cmt",(function(e){var t=e.idPost;d({type:ne,payload:t})})),function(){t&&t.off("res cmt")}}),[d,t]),Object(M.jsxs)("div",{children:[Object(M.jsx)(Et,{open:r,notifications:l}),Object(M.jsx)(D.a,{"aria-label":"notification",onClick:function(){return s(!r)},className:l.length>0?u.root:u.hidden,children:Object(M.jsx)(Dt,{badgeContent:l.length,color:"secondary",children:Object(M.jsx)("img",{src:Pt,className:u.image,alt:""})})})]})}var Lt,zt=Object(P.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},customSpan:{"& img":{verticalAlign:"middle"}}}})),At=function(e){var t=e.postDeleted,n=e.setPostDeleted,i=zt(),a=function(e,t){"clickaway"!==t&&n({})};return t.creatorPostDeleted?Object(M.jsx)("div",{className:i.root,children:Object(M.jsx)(Ct.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:t,autoHideDuration:3e3,onClose:a,children:Object(M.jsxs)(St.a,{onClose:a,severity:"success",elevation:6,variant:"filled",children:[Object(M.jsx)("strong",{children:null===t||void 0===t?void 0:t.creatorPostDeleted})," \u0111\xe3 x\xf3a b\xe0i vi\u1ebft \xa0",Object(M.jsx)("span",{className:i.customSpan,children:(null===t||void 0===t?void 0:t.dataDeleted.length)>=10?":"!==(null===t||void 0===t?void 0:t.dataDeleted[9])?Ve.a.emojify((null===t||void 0===t?void 0:t.dataDeleted.substring(0,10))+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify((null===t||void 0===t?void 0:t.dataDeleted.substring(0,9))+"...",{attributes:{width:"18px",height:"18px"}}):Ve.a.emojify(null===t||void 0===t?void 0:t.dataDeleted,{attributes:{width:"18px",height:"18px"}})})]})})}):null},Mt=function(){var e=Object(i.useState)(JSON.parse(localStorage.getItem("profile"))?JSON.parse(localStorage.getItem("profile")):null),t=Object(g.a)(e,2),n=t[0],a=t[1],o=je(),r=Object(c.b)(),s=Object(u.g)(),l=Object(u.h)(),d=Object(c.c)((function(e){return e.posts})),m=d.posts,b=d.childClicked,f=d.isLoading,x=d.deletedPost,C=d.notifications,S=Object(i.useState)([]),w=Object(g.a)(S,2),_=w[0],N=w[1],P=Object(i.useState)(-2),I=Object(g.a)(P,2),T=I[0],E=I[1],D=Object(i.useState)({data:"",prevCommentId:"",totalSubcomment:0,_id:"",idPost:"",indexPost:-1}),F=Object(g.a)(D,2),L=F[0],z=F[1],A=Object(i.useState)({data:"",prevCommentId:"",totalSubcomment:"",_id:"",index:-1,idPost:""}),R=Object(g.a)(A,2),B=R[0],U=R[1],V=Object(i.useState)({idPost:"",i:-1,idComment:"",idSubCmt:""}),q=Object(g.a)(V,2),K=q[0],Y=q[1],$=Object(i.useState)({}),Q=Object(g.a)($,2),ee=Q[0],te=Q[1],ne=function(){r({type:W}),s.push("/auth")};Object(i.useEffect)((function(){r(function(e){return function(){var t=Object(O.a)(h.a.mark((function t(n){var i,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:G}),t.next=4,oe.get("/posts");case 4:i=t.sent,a=i.data,n({type:J,payload:a}),n({type:X}),t.next=16;break;case 10:t.prev=10,t.t0=t.catch(0),alert(t.t0.response.data.message),n({type:X}),localStorage.clear(),e.push("/auth");case 16:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()}(s))}),[r]);var ie=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T+1!==m.length){e.next=5;break}return e.next=3,N((function(e){return Array(m.length).fill().map((function(t,n){return 0===n?Object(i.createRef)():e[n-1]}))}));case 3:e.next=14;break;case 5:if(T-1!==m.length||-1===x){e.next=11;break}return console.log("delete ref"),e.next=9,N((function(e){return Array(m.length+1).fill().map((function(t,n){return n===x?null:e[n]})).filter((function(e,t){return t!==x}))}));case 9:e.next=14;break;case 11:if(T===m.length){e.next=14;break}return e.next=14,N((function(e){return Array(m.length).fill().map((function(e,t){return Object(i.createRef)()}))}));case 14:return e.next=16,E(m.length);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){ie()}),[m]),Object(i.useEffect)((function(){var e,t=null===n||void 0===n?void 0:n.token;if(t&&1e3*Object(gt.a)(t).exp<(new Date).getTime())return ne();return a(JSON.parse(localStorage.getItem("profile"))),Lt=yt()("https://thuc-tap-20203-1.herokuapp.com/",{auth:{token:null===n||void 0===n?void 0:n.token,userID:null===n||void 0===n||null===(e=n.result)||void 0===e?void 0:e._id}}),n?Lt.emit("home",{},(function(e){var t,i=e.error;e.home;i&&alert(i),Lt.emit("set username",{username:null===n||void 0===n||null===(t=n.result)||void 0===t?void 0:t.email})})):s.push("/auth"),function(){s.push("/auth"),Lt.disconnect(),Lt.off()}}),[l]),Object(i.useEffect)((function(){if(Lt)return Lt.on("comment",function(){var e=Object(O.a)(h.a.mark((function e(t){var n,i,a,o,r,c,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.result,i=n.data,a=n.prevCommentId,o=n.totalSubcomment,r=n._id,c=t.idPost,s=t.indexPost,z({data:i,prevCommentId:a,totalSubcomment:o,_id:r,idPost:c,indexPost:s});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){Lt.off("comment")}}),[L]),Object(i.useEffect)((function(){Lt&&Lt.on("connect_error",(function(e){console.log(e instanceof Error),alert(e.message),localStorage.clear(),s.push("/auth")}))}),[s]),Object(i.useEffect)((function(){if(Lt)return Lt.on("newSubCmt",function(){var e=Object(O.a)(h.a.mark((function e(t){var n,i,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.idPost,i=t.i,a=t.idComment,o=t.idSubCmt,String(K.idSubCmt)===String(o)){e.next=4;break}return e.next=4,Y(Object(j.a)(Object(j.a)({},K),{},{idPost:n,i:i,idComment:a,idSubCmt:o}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){Lt.off("newSubCmt")}}),[K]),Object(i.useEffect)((function(){if(Lt)return Lt.on("subComment",function(){var e=Object(O.a)(h.a.mark((function e(t){var n,i,a,o,r,c,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.result,i=n.data,a=n.prevCommentId,o=n.totalSubcomment,r=n._id,c=t.index,s=t.idPost,U({data:i,prevCommentId:a,totalSubcomment:o,_id:r,index:c,idPost:s});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){Lt.off("subComment")}}),[B]),Object(i.useEffect)((function(){if(Lt)return Lt.on("received postDeleted",function(){var e=Object(O.a)(h.a.mark((function e(t){var n,i,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.creatorPostDeleted,i=t.indexPostDeleted,a=t.idPostDeleted,o=t.dataDeleted,!m||m[i]._id!==a){e.next=7;break}return C.forEach((function(e,t){e.idPost===a?r({type:Z,payload:t}):i<e.indexPost&&(e.indexPost-=1)})),e.next=5,r({type:H,payload:{id:a,indexPost:i}});case 5:return e.next=7,te({creatorPostDeleted:n,dataDeleted:o});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){Lt.off("received postDeleted")}}),[r,m,C]),f?Object(M.jsx)("div",{style:{display:"flex",padding:"5px",flexDirection:"column",width:"100%",placeItems:"center"},children:Object(M.jsx)(v.a,{style:{color:"white"}})}):Object(M.jsx)(y.a,{in:!0,children:Object(M.jsx)(p.a,{component:"main",maxWidth:"lg",className:o.posts,children:n?Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(wt,{getRefs:ie,socket:Lt}),Object(M.jsx)(Ft,{socket:Lt}),ee&&Object(M.jsx)(At,{postDeleted:ee,setPostDeleted:te}),Object(M.jsxs)(k.a,{container:!0,justifyContent:"center",alignItems:"stretch",spacing:3,children:[Object(M.jsx)(k.a,{item:!0,sm:12,md:3,children:Object(M.jsx)(ve,{user:n,socket:Lt,handleLogout:ne})}),Object(M.jsxs)(k.a,{item:!0,sm:12,md:8,children:[Object(M.jsx)(Ot,{user:n,socket:Lt}),m.map((function(e,t){return Object(M.jsx)("div",{ref:_[t],children:Object(M.jsx)(Ze,{newSubCmtToSocket:K,setNewSubCmtToSocket:Y,commentToSocket:L,setCommentToSocket:z,selected:Number(b)===t,refProp:_[t],post:e,socket:Lt,indexPost:t,subCommentToSocket:B,setSubCommentToSocket:U},e._id)},t)}))]})]})]}):Object(M.jsx)(u.a,{to:"/auth"})})})},Rt=Object(Ce.a)((function(e){return{appBar:{display:"flex",borderRadius:15,alignItems:"center",justifyContent:"center",flexDirection:"row"},heading:{color:"rgba(0, 183, 255,1)"}}})),Bt=(n(212),function(){var e=Rt();return Object(M.jsx)(d.a,{children:Object(M.jsxs)(p.a,{maxWidth:"lg",children:[Object(M.jsx)(m.a,{className:e.appBar,position:"static",color:"inherit",children:Object(M.jsx)(b.a,{variant:"h2",align:"center",children:"B\xe0i \u0111\u0103ng"})}),Object(M.jsxs)(u.d,{children:[Object(M.jsx)(u.b,{path:"/",exact:!0,component:Mt}),Object(M.jsx)(u.b,{path:"/auth",exact:!0,component:fe})]})]})})}),Wt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{authData:null,isLoading:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return Object(j.a)(Object(j.a)({},e),{},{isLoading:!0});case X:return Object(j.a)(Object(j.a)({},e),{},{isLoading:!1});case B:return localStorage.setItem("profile",JSON.stringify(Object(j.a)({},null===t||void 0===t?void 0:t.data))),Object(j.a)(Object(j.a)({},e),{},{authData:null});case W:return localStorage.clear(),Object(j.a)(Object(j.a)({},e),{},{authData:null});default:return e}},Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{childClicked:-1,updateNumberCmt:"",deletedPost:-1,isComments:[],notifications:[],newPost:{},isLoading:!1,posts:[],showComment:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return Object(j.a)(Object(j.a)({},e),{},{isLoading:!0});case X:return Object(j.a)(Object(j.a)({},e),{},{isLoading:!1});case $:return Object(j.a)(Object(j.a)({},e),{},{childClicked:t.payload});case Y:return e.notifications.unshift(t.payload),Object(j.a)({},e);case Q:return Object(j.a)(Object(j.a)({},e),{},{notifications:[]});case Z:return Object(j.a)(Object(j.a)({},e),{},{notifications:e.notifications.filter((function(e,n){return n!==t.payload}))});case ie:return Object(j.a)(Object(j.a)({},e),{},{deletedPost:t.payload,posts:e.posts.filter((function(e,n){return n!==t.payload})),isComments:e.isComments.filter((function(e,n){return n!==Number(t.payload)}))});case ne:return Object(j.a)(Object(j.a)({},e),{},{updateNumberCmt:t.payload});case K:return Object(j.a)(Object(j.a)({},e),{},{newPost:t.payload});case J:return Object(j.a)(Object(j.a)({},e),{},{posts:t.payload,isComments:Array(t.payload.length).fill(!1)});case U:return e.posts.unshift(t.payload),e.isComments.unshift(!1),Object(j.a)({},e);case ee:return Object(j.a)(Object(j.a)({},e),{},{isComments:e.isComments.map((function(e,n){return Number(n)===Number(t.payload)?!e:e}))});case te:return Object(j.a)(Object(j.a)({},e),{},{showComment:t.payload});case q:case V:return Object(j.a)(Object(j.a)({},e),{},{posts:e.posts.map((function(e){return e._id===t.payload._id?t.payload:e}))});case H:return Object(j.a)(Object(j.a)({},e),{},{posts:e.posts.filter((function(e){return e._id!==t.payload.id})),deletedPost:t.payload.indexPost,isComments:e.isComments.filter((function(e,n){return n!==Number(t.payload.indexPost)}))});default:return e}},Jt=Object(s.b)({auth:Wt,posts:Ut}),Ht=Object(s.d)(Jt,Object(s.c)(Object(s.a)(l.a)));r.a.render(Object(M.jsx)(c.a,{store:Ht,children:Object(M.jsx)(Bt,{})}),document.getElementById("root"))}},[[213,1,2]]]);
//# sourceMappingURL=main.892d0ab4.chunk.js.map